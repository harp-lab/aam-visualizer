!function(e){function t(t){for(var a,o,l=t[0],s=t[1],i=t[2],d=0,f=[];d<l.length;d++)o=l[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&f.push(r[o][0]),r[o]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);for(u&&u(t);f.length;)f.shift()();return c.push.apply(c,i||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],a=!0,l=1;l<n.length;l++){var s=n[l];0!==r[s]&&(a=!1)}a&&(c.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},r={0:0},c=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var l=window.webpackJsonp=window.webpackJsonp||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var i=0;i<l.length;i++)t(l[i]);var u=s;c.push([145,1]),n()}({141:function(e,t,n){var a=n(142);"string"==typeof a&&(a=[[e.i,a,""]]);var r={insert:"head",singleton:!1};n(144)(a,r);a.locals&&(e.exports=a.locals)},142:function(e,t,n){(t=e.exports=n(79)(!1)).i(n(143),""),t.push([e.i,"body{margin:0}#app{height:100vh}.CodeMirror{height:100%}.CodeMirror .mark{color:#3f51b5;cursor:pointer;font-size:0.6rem;line-height:inherit;padding-right:2px;vertical-align:top}.CodeMirror .mark:hover{color:#7986cb}.CodeMirror .selected{background-color:#fff59d}\n",""])},145:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(9),o=n.n(c),l=n(6),s=n(28);const i="SET_USER",u="SET_TITLE",d="ADD_PROJECT",f="SET_PROJECT_DATA",p="SET_METADATA",m="SET_STATUS",h="SET_GRAPH_METADATA",E="ADD_PANEL",y="SET_PANEL",g="SET_PANELS",v="REFRESH_PANELS",b="DEL_PROJECT",j="DEL_PROJECTS",O="SEL_PROJECT",k={snackbars:[],dialogs:{},loading:!1};var w=function(e=k,t){switch(t.type){case"QUEUE_SNACKBAR":{const{text:n}=t.payload,{snackbars:a}=e;return{...e,snackbars:[...a,n]}}case"DEQUEUE_SNACKBAR":{const{snackbars:t}=e;t.shift();return{...e,snackbars:[...t]}}case"SET_LOADING":{const{loading:n}=t.payload;return{...e,loading:n}}case"SET_DIALOG":{const{dialogId:n,data:a}=t.payload,{dialogs:r}=e;return{...e,dialogs:{...r,[n]:a}}}default:return e}};const S="LOGIN_VIEW",C="LIST_VIEW",x="PROJECT_VIEW",I="empty",T="edit",$="process",P="done",R="error",A="configs",D="envs",M="konts";function _(e={},t){switch(t.type){case h:{const{graphId:n,data:a}=t.payload,r=e[n];return{...e,[n]:{...r,...a}}}default:return e}}function N(e,t){return(n,a)=>{const r=void 0===n;return t(a)||r?e(n,a):n}}function U(e={},t){switch(t.type){case E:{const{panelId:n,label:a}=t.payload;return{...e,[n]:{label:a,saved:!1,hidden:!0,selected:!1}}}case y:{const{panelId:n,data:a}=t.payload,r=e[n];return{...e,[n]:{...r,...a}}}case g:{const{data:e}=t.payload;return{...e}}case v:{const{func:n}=t.payload,a={};for(const[t,r]of Object.entries(e)){const e=n(t,r);a[t]={...r,...e}}return a}default:return e}}const L=Object(s.c)({configs:N(U,e=>!!e.payload&&e.payload.type===A),envs:N(U,e=>!!e.payload&&e.payload.type===D),konts:N(U,e=>!!e.payload&&e.payload.type===M)});function F(e={},t){switch(t.type){case m:{const{data:n}=t.payload;return{...e,...n}}default:return e}}var z=function(e={},t){switch(t.type){case p:{const{data:n}=t.payload;return{...e,...n}}default:{const{graphs:n,panels:a,status:r}=e;return{...e,graphs:_(n,t),panels:L(a,t),status:F(r,t)}}}};const B={status:"empty",code:"",metadata:z(void 0,{type:"INIT"})};var G=function(e=B,t){switch(t.type){case f:{const{data:n}=t.payload;return{...e,...n}}default:{const{metadata:n}=e;return{...e,metadata:z(n,t)}}}};var J=function(e={},t){switch(t.type){case d:case f:default:if(t.payload&&t.payload.projectId){const{projectId:n}=t.payload,a=e[n];return{...e,[n]:G(a,t)}}return e;case b:{const{projectId:n}=t.payload,{[n]:a,...r}=e;return{...r}}case j:return{}}};var H=function(e={},t){switch(t.type){case i:{const{userId:n}=t.payload;return{...e,userId:n}}case u:{const{title:n}=t.payload;return{...e,title:n}}case O:{const{projectId:n}=t.payload;return{...e,selectedProjectId:n}}default:{const{notifications:n,projects:a}=e;return{...e,notifications:w(n,t),projects:J(a,t)}}}},W=n(82);const V=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||s.d;var q=Object(s.e)(H,V(Object(s.a)(W.a)));const K=e=>({type:i,payload:{userId:e}});const Q=e=>({type:u,payload:{title:e}});function Y(e){return e}function X(e){return Y(e).userId}function Z(e){const t=X(e),n=te(e);return t?n?x:C:S}function ee(e){return Y(e).title}function te(e){return Y(e).selectedProjectId}function ne(e){return e.projects}function ae(e){return Object.keys(ne(e))}function re(e,t){return t||(t=te(e)),ne(e)[t]}function ce(e,t){const{items:n}=re(e,t);return n}function oe(e,t){const{status:n}=re(e,t);return n}function le(e,t){return re(e,t).metadata}function se(e,t){const{code:n,items:a,error:r}=re(e,t);return{code:""!==n,items:Boolean(a),error:Boolean(r)}}function ie(e){return ce(e).graphs}function ue(e){return le(e).mainGraphId||"funcs"}function de(e){const t=he(e,ue(e));let n="states";if(t.length>0){const a=t[0],r=ce(e),{form:c}=r.funcs[a];["halt","not found","non-func","unknown"].includes(c)||(n=a)}return n}function fe(e){const t=ue(e);return le(e).focusedGraph||t}function pe(e,t){return ie(e)[t]}function me(e,t){return function(e){return le(e).graphs}(e)[t]||{}}function he(e,t){return me(e,t).selectedNodes||[]}function Ee(e,t){const n=ce(e);switch(t){case"funcs":return n.funcs;case"states":default:return n.configs}}function ye(e){return[ue(e),de(e)].flatMap(t=>{return ve(he(e,t),Ee(e,t))})}function ge(e){return[ue(e),de(e)].flatMap(t=>{return ve(function(e,t){return me(e,t).hoveredNodes||[]}(e,t),Ee(e,t))})}function ve(e,t){const n=new Set;if(t)for(const a of e){const{astLink:e,expr:r}=t[a];let c=[];e?c=e:r&&(c=[r]),c.forEach(e=>n.add(e))}return[...n]}function be(e){return e.notifications}function je(e){const{snackbars:t}=be(e);return t[0]}function Oe(e){return function(e,t){const{dialogs:n}=be(e);return n[t]}(e,"rename")}function ke(e){return le(e).panels}function we(e,t){const n=te(q.getState());return{type:h,payload:{projectId:n,graphId:e,data:t}}}function Se(e,t){return n=>{const a=he(q.getState(),e),r=new Set([...a,...t]);n(we(e,{selectedNodes:[...r]})),n(Be())}}function Ce(e,t){return we(e,{hoveredNodes:t})}function xe(e,t){return n=>{n(we(e,{selectedEdges:t}));const a=q.getState(),{graph:r}=pe(a,e),c=ue(a),o=new Set;for(const e of t){const[t,n]=e.split("-"),a=r[t][n],{calls:c}=a;if(c)for(const e of c)o.add(e)}n(function(e,t){return we(e,{suggestedNodes:t})}(c,[...o]))}}const Ie=e=>({type:"QUEUE_SNACKBAR",payload:{text:e}}),Te=()=>({type:"DEQUEUE_SNACKBAR"}),$e=e=>({type:"SET_DIALOG",payload:{dialogId:"rename",data:e}});function Pe(e,t,n){const a=te(q.getState());return{type:y,payload:{projectId:a,type:e,panelId:t,data:n}}}function Re(e,t,n){return{type:g,payload:{projectId:e,type:t,data:n}}}const Ae=(e,t)=>Pe(e,t,{hidden:!0}),De=(e,t)=>Pe(e,t,{hidden:!1}),Me=(e,t)=>Pe(e,t,{saved:!0}),_e=(e,t)=>Pe(e,t,{saved:!1}),Ne=(e,t)=>Pe(e,t,{selected:!0}),Ue=(e,t)=>Pe(e,t,{selected:!1}),Le=e=>De(M,e),Fe=e=>De(D,e);function ze(e,t){const n=te(q.getState());return{type:v,payload:{projectId:n,type:e,func:t}}}function Be(){return e=>{e(function(){const e=q.getState(),t=de(e),n=he(e,t);return ze(A,(e,t)=>n.includes(e)?{selected:!0,hidden:!1}:{hidden:!0})}()),e(Ge()),e(Je())}}function Ge(){const e=q.getState(),t=ce(e),{configs:n,envs:a}=ke(e),r=[];for(const[e,a]of Object.entries(n))if(!a.hidden&&a.selected){const n=t.configs[e].states;if(n)for(const e of n){const n=t.states[e].env;n&&r.push(n)}}return ze(D,(e,t)=>r.includes(e)?{hidden:!1}:{hidden:!0})}function Je(){const e=q.getState(),t=ce(e),{configs:n,konts:a}=ke(e),r=[];for(const[e,a]of Object.entries(n))if(!a.hidden&&a.selected){const n=t.configs[e].states;if(n)for(const e of n){const n=t.states[e].kont;r.push(n)}}return ze(M,(e,t)=>r.includes(e)?{hidden:!1}:{hidden:!0})}function He(e){return t=>{const n=ce(q.getState(),e);n.configs&&t(function(e){return t=>{const n=ce(q.getState(),e),a={};for(const[e,t]of Object.entries(n.configs)){const{form:r,states:c}=t;let o;if(c){const e=c[0],t=n.states[e];switch(t.form){case"halt":if(t.results){o=`[ ${t.results.map(e=>{const{type:t,name:a,valString:r}=n.vals[e];let c;switch(t){case"closure":c=a;break;case"bool":c=r}return c}).join(", ")} ]`}break;default:o=t.exprString}}const l=`${e}: ${r} - ${o}`;a[e]=We(l)}t(Re(e,A,a))}}(e)),n.envs&&t(function(e){return t=>{const n=ce(q.getState(),e),a={};for(const[e,t]of Object.entries(n.envs)){const n=`${e}: [ ${t.map(e=>e.varString).join(", ")} ]`;a[e]=We(n)}t(Re(e,D,a))}}(e)),n.konts&&t(function(e){return t=>{const n=ce(q.getState(),e),a={};for(const[e,t]of Object.entries(n.konts)){const{descs:t}=n.konts[e];let r=`${e}: `;t.length>1?r+=`[ ${t[0]}, ... +${t.length-1} ]`:r+=`[ ${t[0]} ]`,a[e]=We(r)}t(Re(e,M,a))}}(e))}}function We(e){return{label:e,saved:!1,hidden:!0,selected:!1}}const Ve=e=>({type:d,payload:{projectId:e}}),qe=(e,t)=>({type:f,payload:{projectId:e,data:t}}),Ke=e=>({type:b,payload:{projectId:e}}),Qe=()=>({type:j});function Ye(e){return t=>{if(e){const n=q.getState(),{name:a}=re(n,e);t(Q(a||e))}t({type:O,payload:{projectId:e}})}}const Xe=(e,t)=>({type:p,payload:{projectId:e,data:t}});function Ze(e,t){const n=X(q.getState());return fetch(`/api/${n}/${e}`,{method:t})}function et(){return async function(e){const t=await Ze("create","GET"),n=(await t.json()).id;return e(Ve(n)),e(Ye(void 0)),n}}function tt(e){return async function(t){let n=q.getState(),a=re(n,e);a.status!==I&&(await t(nt(e)),a=re(n=q.getState(),e));const r=await t(et()),{code:c,analysis:o}=a;t(qe(r,{code:c,analysis:o})),t(Ye(r))}}function nt(e){return async function(t){const n=await Ze(`projects/${e}/code`,"GET"),{code:a}=await n.json();t(qe(e,{code:a}))}}function at(e,t){return n=>{const a=q.getState(),{userId:r,status:c}=re(a,e);switch(c){case I:case T:{let a=T;return""==t&&(a=I),n(qe(e,{status:a,code:t})),fetch(`/api/${r}/projects/${e}/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:t})})}}}}function rt(e){return async function(t){const n=await Ze(`projects/${e}/data`,"GET");switch(n.status){case 200:{const a=await n.json();return t(qe(e,a)),n.status}case 204:return n.status;case 412:return t(Ie("Project data request rejected")),n.status}}}function ct(e){return async function(t){switch(await t(rt(e))){case 200:{const t=re(q.getState(),e),n={};for(const[e,a]of Object.entries(t))["analysis","code","items"].includes(e)&&(n[e]=a);const a=JSON.stringify(n,null,2),r=new Blob([a],{type:"application/json"}),c=URL.createObjectURL(r),o=`aam-vis-${e}.json`,l=document.createElement("a");Object.assign(l,{href:c,download:o}),document.body.appendChild(l),l.click(),l.remove(),URL.revokeObjectURL(c);break}case 204:t(Ie("Project still processing"))}}}var ot=n(222),lt=n(204),st=n(46),it=n(193),ut=n(223),dt=n(205),ft=n(225);var pt=function(){const e=Object(l.c)(),[t,n]=Object(a.useState)("guest"),c=!/^\w+$/.test(t);return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%",justifyContent:"center",alignContent:"center",alignItems:"center"}},r.a.createElement(ft.a,{label:"username",value:t,onChange:e=>n(e.target.value),error:c,helperText:"You can use letters, numbers, & underscores"}),r.a.createElement(it.a,{onClick:()=>e(function(e){return t=>{t(K(e))}}(t)),disabled:c},"login"))},mt=n(192),ht=n(147),Et=n(206),yt=n(207),gt=n(148),vt=n(87),bt=n.n(vt),jt=n(85),Ot=n.n(jt),kt=n(86),wt=n.n(kt),St=n(230),Ct=n(94),xt=n(194),It=n(84),Tt=n.n(It);var $t=function(e){const{items:t}=e,[n,c]=Object(a.useState)(void 0);function o(){c(void 0)}const l=t.map(e=>{const{label:t,callback:n}=e;return r.a.createElement(xt.a,{key:t,onClick:()=>{o(),n()}},t)});return r.a.createElement(a.Fragment,null,r.a.createElement(St.a,{title:"More"},r.a.createElement(gt.a,{color:"inherit",onClick:function(e){c(e.currentTarget)}},r.a.createElement(Tt.a,null))),r.a.createElement(Ct.a,{anchorEl:n,getContentAnchorEl:void 0,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},open:Boolean(n),onClose:o},l))};class Pt extends a.Component{constructor(e){super(e),this.state={error:!1}}static getDerivedStateFromError(e){return{error:!0}}componentDidCatch(e,t){}render(){return this.state.error?r.a.createElement(zt,{content:"Error caught"}):this.props.children}}var Rt=Pt,At=n(195);function Dt(){return(Dt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var Mt=function(e){const{content:t,tooltip:n,onClick:a,style:c}=e;return r.a.createElement(St.a,{title:n},r.a.createElement(At.a,Dt({onClick:e=>{e.stopPropagation(),a()}},{style:c}),r.a.createElement(st.a,{display:"inline",style:{cursor:"pointer"}},t)))},_t=n(196),Nt=n(197),Ut=n(198);var Lt=function(e){const{status:t,variant:n="circular"}=e;let a;switch(n){case"circular":a=r.a.createElement(Ft,{style:{justifyContent:"center",alignItems:"center"}},r.a.createElement(_t.a,{in:!0,style:{transitionDelay:"1000ms"}},r.a.createElement(Nt.a,null)),r.a.createElement(_t.a,{in:!0,style:{transitionDelay:"200ms"}},r.a.createElement(st.a,{variant:"h6",style:{marginTop:"2em"}},t)));break;case"linear":a=r.a.createElement(Ft,null,r.a.createElement(Ut.a,null),r.a.createElement(st.a,{variant:"h6",style:{flex:"1 1 auto",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},this.props.status))}return a};var Ft=function(e){const{overflow:t,children:n,style:c}=e,o=Object(a.useContext)(en),{height:l,width:s}=o;return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",height:l||"100%",width:s||"100%",overflow:t||"hidden",...c}},r.a.createElement(Rt,null,n))};var zt=function(e){const{content:t}=e;return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%",justifyContent:"center",alignItems:"center"}},r.a.createElement(st.a,{variant:"h6"},t))},Bt=n(201),Gt=n(202),Jt=n(203),Ht=n(200),Wt=n(199);var Vt=function(e){const t=e.labels.map(e=>r.a.createElement(Wt.a,{key:e},e)),n=e.entries.map((e,t)=>{const n=e.map((e,t)=>r.a.createElement(Wt.a,{key:t},e));return r.a.createElement(Ht.a,{key:t},n)});return r.a.createElement(Bt.a,{size:"small"},r.a.createElement(Gt.a,null,r.a.createElement(Ht.a,null,t)),r.a.createElement(Jt.a,null,n))};function qt(e){const t=e.theme;return r.a.createElement(lt.a,{variant:"dense",style:{backgroundColor:t.palette.secondary.main,color:t.palette.secondary.contrastText,minHeight:"auto"}},r.a.createElement(st.a,null,e.content))}qt=Object(dt.a)(qt);var Kt=function(e){const{label:t,panels:n}=e,c=[...Object.entries(n).filter(([t,n])=>{const{saved:a}=n,r=a;let c=!0;return e.onFilterSaved&&(c=e.onFilterSaved([t,n])),r&&c}).map(e.onGenerate),...Object.entries(n).filter(([t,n])=>{const{saved:a,hidden:r}=n,c=!a&&!r;let o=!0;return e.onFilterUnsaved&&(o=e.onFilterUnsaved([t,n])),c&&o}).map(e.onGenerate)];return r.a.createElement(a.Fragment,null,r.a.createElement(qt,{content:t}),r.a.createElement("div",{style:{overflowY:"auto"}},c))};var Qt=function(e){const{children:t,childrenStyle:n}=e,a=r.a.Children.map(t,e=>{if(e)return r.a.cloneElement(e,{style:n})});return r.a.createElement("div",null,a)};function Yt(){return(Yt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Xt(e){const{horizontal:t,onMouseDown:n}=e;let a;return a=t?{height:5,cursor:"ns-resize"}:{width:5,cursor:"ew-resize"},r.a.createElement("div",{style:{backgroundColor:"darkgray",...a},onMouseDown:n})}var Zt=function(e){const{horizontal:t,children:n}=e,c=Object(a.useRef)(void 0),[o,l]=Object(a.useState)(!1),s=n[0].props,i=parseInt(s.width||s.height),[u,d]=Object(a.useState)(i);function f(){o&&l(!1)}let p,m,h;t?(p="height",m="horizontal",h="ns-resize"):(p="width",m="vertical",h="ew-resize");const[E,y]=n;return r.a.createElement("div",{ref:c,style:{display:"flex",flexDirection:t?"column":"row",flex:"1 1 auto",cursor:o?h:"default",minHeight:0},onMouseMove:function(e){if(o){!function(){const e=window.getSelection();e&&e.removeAllRanges()}();const n=c.current.getBoundingClientRect();let a;a=t?(e.clientY-n.y)/n.height*100:(e.clientX-n.x)/n.width*100,d(a)}},onMouseUp:f,onMouseLeave:f},r.a.createElement(en.Provider,{value:{[p]:`${u}%`}},E),r.a.createElement(Xt,Yt({[m]:!0},{onMouseDown:function(){l(!0)}})),r.a.createElement(en.Provider,{value:{[p]:`${100-u}%`}},y))},en=r.a.createContext({});function tn(e){const{projectId:t}=e,n=Object(l.d)(e=>re(e,t)),a=Object(l.c)(),c=r.a.createElement(Et.a,{style:{flex:"0 0 10em"}},n.analysis),o=r.a.createElement(Et.a,{style:{overflow:"hidden",textOverflow:"ellipsis"}},n.name||"unnamed"),s=r.a.createElement(Et.a,{style:{flex:"0 0 10em"}},t),i=r.a.createElement(Et.a,{style:{flex:"0 0 10em"}},n.status);let u;u=n.status==$?r.a.createElement(St.a,{title:"Cancel processing"},r.a.createElement(gt.a,{onClick:()=>a(function(e){return async function(t){switch((await Ze(`projects/${e}/cancel`,"POST")).status){case 200:t(qe(e,{status:T}));break;case 409:t(Ie(`Project ${e} cancel request denied - already finished`));break;default:t(Ie(`Project ${e} cancel request failed`));break}}}(t))},r.a.createElement(Ot.a,null))):r.a.createElement(St.a,{title:"Delete"},r.a.createElement(gt.a,{onClick:()=>a(function(e){return async function(t){const n=te(q.getState());switch((await Ze(`projects/${e}/delete`,"POST")).status){case 205:t(Ke(e)),n==e&&t(Ye(void 0));break;default:t(Ie(`Project ${e} delete request failed`))}}}(t))},r.a.createElement(wt.a,null)));const d=r.a.createElement(yt.a,null,r.a.createElement($t,{items:[{label:"Rename",callback:()=>a($e(t))},{label:"Export",callback:()=>a(ct(t))}]}),r.a.createElement(St.a,{title:"Fork"},r.a.createElement(gt.a,{onClick:()=>a(tt(t))},r.a.createElement(bt.a,null))),u);return r.a.createElement(ht.a,{button:!0,key:t,onClick:()=>a(Ye(t)),align:"flex-start",style:{paddingRight:160}},c,o,s,i,d)}var nn=function(){const e=Object(l.d)(ae),t=Object(l.c)(),n=Object(a.useRef)(void 0);async function c(){await t((async function(e){const t=await Ze("all","GET");let n=!1;switch(t.status){case 200:{const a=await t.json();for(const[t,r]of Object.entries(a)){const{status:a,name:c,analysis:o}=r;e(qe(t,{status:a,name:c,analysis:o})),a===$&&(n=!0)}break}default:n=!0}return n}))&&(n.current=setTimeout(c,1e3))}Object(a.useEffect)(()=>(c(),()=>{clearTimeout(n.current)}),[]);const o=e.map(e=>r.a.createElement(tn,{key:e,projectId:e}));return r.a.createElement(mt.a,{style:{overflowY:"auto"}},o)},an=n(229),rn=n(224),cn=n(56),on=n.n(cn);n(119);function ln(e){const{onClick:t}=e;return r.a.createElement(it.a,{onClick:t,variant:"contained",color:"secondary"},"process")}var sn=function(e){const{edit:t,error:n}=e,c=["0-cfa","1-cfa","2-cfa"],o=Object(a.useRef)(void 0),s={lineWrapping:!0,lineNumbers:!0,readOnly:!t},i=Object(a.useRef)(on.a),[u,d]=Object(a.useState)({analysis:c[0]}),f=Object(l.d)(te),{code:p,error:m}=Object(l.d)(re),h=Object(l.c)();function E(){return i.current.getDoc().getValue()}let y,g;if(Object(a.useEffect)(()=>(i.current=on.a.fromTextArea(o.current,s),()=>{i.current.toTextArea(),h(at(f,E()))}),[]),Object(a.useEffect)(()=>{!function(e){i.current.getDoc().setValue(e)}(p)},[p]),t){y=r.a.createElement(st.a,null,"Input code for analysis");const e=c.map(e=>r.a.createElement(xt.a,{key:e,value:e},e));g=r.a.createElement(lt.a,null,r.a.createElement("div",{style:{flex:"1 1 auto"}},r.a.createElement(an.a,null,"Analysis"),r.a.createElement(rn.a,{value:u.analysis,onChange:e=>{const t=e.target.value;d({...u,analysis:t})}},e)),r.a.createElement(ln,{onClick:function(){h(function(e,t,n){return async function(a){a(at(e,t));const r=q.getState(),{userId:c}=re(r,e);switch((await fetch(`/api/${c}/projects/${e}/process`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).status){case 200:a(qe(e,{status:"process"}));break;case 412:a(Ie("Project process request rejected"))}}}(f,E(),u))}}))}else n&&(y=r.a.createElement(a.Fragment,null,r.a.createElement(st.a,{variant:"h3"},"Analysis error"),r.a.createElement(st.a,null,m)));return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"auto"}},y,r.a.createElement("textarea",{ref:e=>o.current=e,style:{flex:"1 1 auto",overflow:"auto",height:"100%"}}),g)},un=n(88),dn=n.n(un);var fn=function(e,t){return{group:"nodes",data:{id:e,label:`${e}\n${t}`,form:t}}};var pn=function(e,t,n,a){const{label:r="",style:c}=a;return{group:"edges",data:{id:e,label:r,source:t,target:n,style:c}}};var mn=function(e,t){const n=t.graphs[e],{graph:a,start:r}=n;function c(e,t){const n=[];for(const[a,r]of Object.entries(e)){let e;t&&(e=t[a].form),n.push(fn(a,e));for(const[c,o]of Object.entries(r)){t&&(e=t[c].form),n.push(fn(c,e));const r=`${a}-${c}`;n.push(pn(r,a,c,o))}}return n}switch(e){case"funcs":return c(a,t.funcs);case"states":default:return c(a,t.configs)}};function hn(e){const t=Object(a.useRef)(void 0),n=Object(a.useRef)(void 0),c=Object(a.useRef)(!1),{graphId:o,edgePredicate:s,onNodeSelect:i,onNodeUnselect:u,theme:d}=e,f=Object(l.d)(ce);if(!f.graphs[o])return r.a.createElement(zt,{content:`'${o}' graph undefined`});const p=mn(o,f),m=Object(l.d)(e=>me(e,o)),h=Object(l.d)(fe)===o,E=Object(l.c)(),y={style:[{selector:"node",style:{label:"data(label)","text-wrap":"wrap"}},{selector:"node:selected",style:{"background-color":d.palette.select.main}},{selector:"edge",style:{label:"data(label)","curve-style":"bezier","target-arrow-shape":"triangle","line-style":(g="line-style",v="solid",e=>{const t=e.data("style");let n;return n=t&&t[g]?t[g]:v})}},{selector:"edge:selected",style:{"line-color":d.palette.select.main,"target-arrow-color":d.palette.select.main}},{selector:".suggested",style:{"background-color":d.palette.suggest.main}},{selector:e=>e.hasClass("suggested")&&e.selected(),style:{"background-color":d.palette.suggest.dark}},{selector:".hovered",style:{"background-color":d.palette.hover.main}}],headless:!0};var g,v;const b=Object(a.useRef)(dn()(y)).current,{positions:j,selectedNodes:O=[],selectedEdges:k=[],hoveredNodes:w=[],suggestedNodes:S=[]}=m;function C(e){const t=b.$("node:selected");switch(e.key){case"ArrowLeft":const e=t.incomers().nodes();1==e.length&&(t.unselect(),e.select());break;case"ArrowRight":const n=t.outgoers().nodes();1==n.length&&(t.unselect(),n.select())}}function x(e,t){b.batch(()=>{for(const n of e){b.getElementById(n).addClass(t)}})}function I(e,t){b.batch(()=>{for(const n of e){b.getElementById(n).removeClass(t)}})}return Object(a.useEffect)(()=>(b.mount(t.current),()=>b.unmount()),[]),Object(a.useEffect)(()=>{if(h)return document.addEventListener("keydown",C),()=>{document.removeEventListener("keydown",C)}},[h]),Object(a.useEffect)(()=>(["tap","select","unselect","mouseover","mouseout"].forEach(e=>b.off(e)),b.on("tap",()=>E(function(e){const t=te(q.getState());return Xe(t,{focusedGraph:e})}(o))),b.on("select","node",e=>{if(c.current){const t=e.target.id();E(Se(o,[t])),i&&i(t)}}),b.on("unselect","node",e=>{if(c.current){const t=e.target.id();E(function(e,t){return n=>{const a=he(q.getState(),e),r=new Set(a);t.forEach(e=>r.delete(e)),n(we(e,{selectedNodes:[...r]})),n(Be())}}(o,[t])),u&&u(t)}}),b.on("mouseover","node",e=>{const t=e.target.id();w!=[t]&&E(Ce(o,[t]))}),b.on("mouseout","node",e=>{E(Ce(o,[]))}),b.on("select","edge",e=>{if(c.current){const t=e.target;if(s(t)){const e=t.id();E(xe(o,[e]))}else t.unselect()}}),b.on("unselect","edge",e=>{c.current&&E(xe(o,[]))}),b.add(p),j?(b.nodes().positions(e=>j[e.data("id")]),b.fit()):b.layout({name:"cose",directed:!0}).run(),()=>{const e={};for(const t of p){const n=t.data.id;e[n]=b.$id(n).position()}E(function(e,t){return we(e,{positions:t})}(o,e)),b.nodes().remove()}),[o]),Object(a.useEffect)(()=>{return c.current=!1,function(e){e.forEach(e=>b.$id(e).select())}([...O,...k]),c.current=!0,()=>{c.current=!1,function(e){e.forEach(e=>b.$id(e).unselect())}([...O,k]),c.current=!0}},[O,k]),Object(a.useEffect)(()=>(c.current=!1,x(S,"suggested"),c.current=!0,()=>{c.current=!1,I(S,"suggested"),c.current=!0}),[S]),Object(a.useEffect)(()=>(c.current=!1,x(w,"hovered"),c.current=!0,()=>{c.current=!1,I(w,"hovered"),c.current=!0}),[w]),Object(a.useEffect)(()=>{b.resize()},[n.current]),Object(a.useEffect)(()=>{n.current=t.current.getBoundingClientRect()}),r.a.createElement("div",{style:{flex:"1 1 1%",display:"block",minHeight:0,width:"100%"},ref:t})}var En=hn=Object(dt.a)(hn);function yn(e){const{content:t,theme:n}=e;return r.a.createElement(lt.a,{variant:"dense",style:{backgroundColor:n.palette.grey[300],color:n.palette.text.primary,width:"100%",minHeight:"unset"}},r.a.createElement(st.a,null,t))}yn=Object(dt.a)(yn);var gn=function(){const e=Object(l.d)(ue),t=Object(l.d)(de);return r.a.createElement(Zt,{horizontal:!0},r.a.createElement(Ft,{height:"50%"},r.a.createElement(yn,{content:e}),r.a.createElement(En,{graphId:e,edgePredicate:e=>!1})),r.a.createElement(Ft,{height:"50%"},r.a.createElement(yn,{content:t}),r.a.createElement(En,{graphId:t,edgePredicate:e=>{const t=e.data("style");return!!t&&"dashed"===t["line-style"]}})))};var vn=class{constructor(e,t){this.line=e,this.ch=t}toString(){return`line ${this.line} ch ${this.ch}`}},bn=n(66),jn=n.n(bn);var On=class{constructor(e,t){this.start=e,this.end=t,this.nodes={}}addNode(e,t){this.nodes[e]?this.nodes[e].push(t):this.nodes[e]=[t]}in(e,t,n){let a=!1;if(t.line==n.line){const r=t.line<=e.line&&e.line<=n.line,c=t.ch<=e.ch&&e.ch<n.ch;r&&c&&(a=!0)}else{const r=e.line==t.line,c=e.line==n.line,o=t.line<e.line&&e.line<n.line,l=t.ch<=e.ch,s=e.ch<n.ch;(r&&l||o||c&&s)&&(a=!0)}return a}startsIn(e,t){return this.in(this.start,e,t)}endsIn(e,t){return this.in(new vn(this.end.line,this.end.ch-1),e,t)}includes(e,t){const n=this.in(e,this.start,this.end),a=this.in(new vn(t.line,t.ch-1),this.start,this.end);return n&&a}has(e){return this.in(e,this.start,this.end)}smallerThan(e){const t=this.end.line-this.start.line<e.end.line-e.start.line,n=this.end.ch-this.start.ch<e.end.ch-e.start.ch;return t||!t&&n}coverage(e,t){let n,a;const r=this.includes(e,t);let c;return this.startsIn(e,t)?n=this.start:r&&(n=e),this.endsIn(e,t)?a=this.end:r&&(a=t),c=n&&a?a.ch-n.ch:0}};function kn(e){const{code:t}=Object(l.d)(re),n=Object(l.d)(ue),c=Object(l.d)(de),o=Object(l.d)(ce),s=[];o.graphs[n]&&s.push(n),o.graphs[c]&&s.push(c);const i=Object(l.d)(ye),u=Object(l.d)(ge),d=Object(l.c)(),f={};if(o.ast){for(const[e,t]of Object.entries(o.ast)){const{start:n,end:a}=t,r=new vn(n[0],n[1]),c=new vn(a[0],a[1]);f[e]=new On(r,c)}s.forEach(e=>(function(e){const t=function(e){const{graph:t}=o.graphs[e],n=[];for(const[e,a]of Object.entries(t))n.push(e),n.concat(Object.keys(a));return n}(e),n=function(e){switch(e){case"funcs":return o.funcs;case"states":default:return o.configs}}(e);for(const a of t){const t=ve([a],n);for(const n of t)f[n].addNode(e,a)}})(e))}const[p,m]=Object(a.useState)("auto"),{theme:h}=e,E=Object.entries(f).reduce((e,t)=>{const[n,a]=t;return Object.keys(a.nodes).length>0&&(e[n]=a),e},{});function y(){for(const e of s)d(Ce(e,void 0))}const g=t.split(/\r\n|\n/).map(e=>e.match(/\(|\)|\[|\]|\#t|\#f|\w+|\s+/g)),v=g.map((e,t)=>{let n=0;e||(e=[" "]);const a=e.map((e,a)=>{const c=new vn(t,n),o=new vn(t,n+e.length);n+=e.length;let l="inherit";e.match(/lambda|let|if|\#t|\#f/)&&(l=jn.a[800]);const s=u.map(e=>E[e]).filter(e=>void 0!==e),f=i.map(e=>E[e]).filter(e=>void 0!==e),p=s.find(e=>e.includes(c,o)),m=f.find(e=>e.includes(c,o));let g=e;p?g=r.a.createElement(wn,{content:e,color:h.palette.hover.light}):m&&(g=r.a.createElement(wn,{content:e,color:h.palette.select.light}));const v=function(e,t){const n=new vn(e,t);let a;return Object.entries(E).forEach(([e,t])=>{if(t.has(n))if(a){const n=E[a];t.smallerThan(n)&&(a=e)}else a=e}),a}(t,c.ch);return r.a.createElement(Sn,{key:a,content:g,textColor:l,onMouseOver:()=>(function(e){if(y(),e)for(const[t,n]of Object.entries(E[e].nodes))d(Ce(t,n))})(v),onClick:()=>(function(e){const t=E[e],n=t.nodes,a=Object.keys(t.nodes).filter(e=>"funcs"!==e);if(a.length>0){const e=a[0],t=n[e];d(Se(e,t))}})(v),style:{cursor:"pointer"}})}),c=r.a.createElement("div",{style:{display:"inline-block",width:p,fontFamily:'Roboto Mono, "Courier New", Courier, monospace',backgroundColor:h.palette.grey[200],textAlign:"right",padding:"0 5px"}},r.a.createElement(st.a,{variant:"body2",ref:e=>{const n=t==g.length-1;if(e&&n){const t=e.getBoundingClientRect(),n=t.width;p!==n&&m(t.width)}},color:"textSecondary"},t+1));return r.a.createElement("div",{key:t},c,r.a.createElement(st.a,{onMouseLeave:()=>y(),variant:"body2",style:{display:"inline-block",verticalAlign:"bottom",fontFamily:'Roboto Mono, "Courier New", Courier, monospace'}},a))});return r.a.createElement("div",{style:{whiteSpace:"pre"}},v)}function wn(e){const{content:t,color:n}=e;return r.a.createElement(Sn,{content:t,color:n})}function Sn(e){const{content:t,color:n,textColor:a,style:c,onClick:o,onMouseOver:l}=e;return r.a.createElement("span",{onMouseOver:l,onClick:o,style:{display:"inline-block",backgroundColor:n||"inherit",color:a||"inherit",...c}},t)}var Cn=kn=Object(dt.a)(kn),xn=n(217),In=n(218),Tn=n(226),$n=n(214),Pn=n(216),Rn=n(208),An=n(209),Dn=n(210),Mn=n(211),_n=n(212),Nn=n(213),Un=n(215),Ln=n(149);function Fn(){return(Fn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function zn(e){const{panelId:t,panelType:n,children:c,theme:o,classes:s,onSelect:i,onUnselect:u,onMouseOver:d,onMouseOut:f}=e,p=Object(l.d)(ke)[n][t],m=Object(l.c)(),[h,E]=Object(a.useState)(!1);const{label:y,selected:g,saved:v}=p;let b,j;j=e.disableSelect?r.a.createElement(Bn,{icon:r.a.createElement(Rn.a,{color:"disabled"}),tooltip:e.disableSelectMsg,disabled:!0}):g?r.a.createElement(Bn,{icon:r.a.createElement(Dn.a,null),tooltip:"Unselect",onClick:function(){m(Ue(n,t)),u&&u()}}):r.a.createElement(Bn,{icon:r.a.createElement(An.a,null),tooltip:"Select",onClick:function(){m(Ne(n,t)),i&&i()}}),b=v?r.a.createElement(Bn,{icon:r.a.createElement(_n.a,null),tooltip:"Unsave",onClick:()=>m(_e(n,t))}):r.a.createElement(Bn,{icon:r.a.createElement(Mn.a,null),tooltip:"Save",onClick:()=>m(Me(n,t))});const O=r.a.createElement(Bn,{icon:r.a.createElement(Nn.a,null),tooltip:"Delete",onClick:()=>m(Ae(n,t))});return r.a.createElement(Tn.a,{onMouseOver:()=>{h||(d(),E(!0))},onMouseOut:()=>{h&&(f(),E(!1))},defaultExpanded:!v},r.a.createElement($n.a,{expandIcon:r.a.createElement(Un.a,null),classes:{root:s.panelRoot,content:s.panelContent,expandIcon:s.panelExpandIcon,expanded:s.panelExpanded},style:{backgroundColor:h?o.palette.hover.light:void 0}},j,b,O,r.a.createElement(st.a,null,y)),r.a.createElement(Pn.a,null,c))}function Bn(e){const{icon:t,tooltip:n,disabled:a,onClick:c}=e,o={};return a?(o.disableRipple=!0,o.onClick=e=>{e.stopPropagation()}):o.onClick=e=>{e.stopPropagation(),c()},r.a.createElement(St.a,{title:n},r.a.createElement(gt.a,Fn({size:"small"},o),t))}var Gn=zn=Object(Ln.a)(e=>({panelRoot:{minHeight:0,"&$panelExpanded":{minHeight:0}},panelContent:{alignItems:"center",margin:"5px 0","&$panelExpanded":{margin:"8px 0"}},panelExpandIcon:{padding:"5px 12px"},panelExpanded:{}}),{withTheme:!0})(zn);function Jn(){return(Jn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var Hn=function(e){const{envId:t,style:n}=e,a=Object(l.c)();return r.a.createElement(Mt,Jn({content:`env-${t}`,tooltip:"Show environment",onClick:()=>a(Fe(t))},{style:n}))};function Wn(){return(Wn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var Vn=function(e){const{kontId:t,style:n}=e,a=Object(l.c)();return r.a.createElement(Mt,Wn({content:`stack-${t}`,tooltip:"Show stack",onClick:()=>a(Le(t))},{style:n}))};var qn=function(e){const{valId:t}=e,n=Object(l.d)(ce),{type:a,astString:c,valString:o}=n.vals[t];let s;switch(a){case"bool":s=o;break;case"closure":s=c;break;default:s=`'${a}' value type unsupported`}return r.a.createElement(st.a,null,s)};function Kn(){return(Kn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Qn(e){const{configId:t}=e,n=Object(l.d)(ce),{states:a}=n.configs[t];let c;return a&&(c=a.map(e=>{const{form:t}=n.states[e];switch(t){case"halt":return;default:return r.a.createElement(Yn,{key:e,stateId:e})}})),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%"}},c)}function Yn(e){const{stateId:t}=e,n=Object(l.d)(ce),{instr:a,kont:c,env:o,vals:s}=n.states[t],i=n.instr[a].exprStrings.join(", "),u=r.a.createElement(st.a,{display:"inline"},`[ ${i} ]`),d=r.a.createElement(Vn,{kontId:c}),f=o?r.a.createElement(Hn,{envId:o}):void 0;let p;return s&&(p=s.map((e,t)=>{const n=e.map(e=>r.a.createElement(qn,{key:e,valId:e}));return r.a.createElement("div",{key:t,style:{flex:"1 1 auto"}},n)})),r.a.createElement(xn.a,{style:{width:"100%"}},r.a.createElement(In.a,{style:{padding:8}},r.a.createElement(Qt,{childrenStyle:{marginRight:5}},u,d,f),r.a.createElement("div",{style:{display:"flex"}},p)))}var Xn=function(){const{configs:e}=Object(l.d)(ke),t=Object(l.d)(ce),n=Object(l.d)(de),a=Object(l.c)();function c(){a(Ge()),a(Je())}const o={onFilterSaved:function([e,n]){return!["not found","non-func"].includes(t.configs[e].form)},onFilterUnsaved:function([e,n]){return!["not found","non-func"].includes(t.configs[e].form)}};return r.a.createElement(Kt,Kn({label:"Configurations",panels:e,onGenerate:function([e,t]){return r.a.createElement(Gn,{key:e,panelId:e,panelType:"configs",onMouseOver:()=>a(Ce(n,[e])),onMouseOut:()=>a(Ce(n,[])),onSelect:c,onUnselect:c},r.a.createElement(Qn,{configId:e}))}},o))};var Zn=function(){const{envs:e}=Object(l.d)(ke);return r.a.createElement(Kt,{label:"Environments",panels:e,onGenerate:function([e,t]){return r.a.createElement(Gn,{key:e,panelId:e,panelType:"envs",onMouseOver:()=>{},onMouseOut:()=>{},disableSelect:!0,disableSelectMsg:"No action"},r.a.createElement(ea,{envId:e}))}})};function ea(e){const{envId:t}=e,n=Object(l.d)(ce),{envs:a,instr:c,store:o,vals:s}=n,i=a[t].map(e=>{const t=c[e.instr].exprStrings.join(", "),n=o[e.addr].map(e=>{const{env:t,type:n,astString:a,valString:c}=s[e];let o;switch(n){case"closure":o=a;break;case"bool":o=c;break;default:o=`'${n}' value type unsupported`}const l=t?r.a.createElement(Hn,{envId:t}):void 0;return r.a.createElement(Qt,{key:e,childrenStyle:{marginRight:5}},r.a.createElement(st.a,{display:"inline"},o),l)});return[e.varString,`[ ${t} ]`,n]});return r.a.createElement(Vt,{labels:["var","instr","store"],entries:i})}var ta=n(190),na=n(219);var aa=class{constructor(e){this.cardIds=e,this.selected=void 0}select(e){this.selected=e}unselect(e){this.selected=void 0}get cards(){return this.cardIds}};function ra(){return(ra=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ca(e){const{kontId:t}=e,[n,c]=Object(a.useState)([new aa([t])]);function o(e){return n.slice(0,e+1)}const l=n.map((e,t)=>r.a.createElement(oa,{key:t,layer:e,onSet:(e,n)=>(function(e,t,n){const a=o(e);a[a.length-1].select(t),c([...a,n])})(t,e,n),onUnset:e=>(function(e,t){const n=o(e);n[n.length-1].unselect(t),c(n)})(t,e)}));return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%"}},l)}function oa(e){const{layer:t}=e,n=t.cards.map(n=>r.a.createElement(la,{key:n,kontId:n,selected:t.selected==n,onSet:e.onSet,onUnset:e.onUnset}));return r.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",margin:"5px 0"}},n)}function la(e){const{kontId:t,selected:n,theme:a,classes:c}=e,o=Object(l.d)(ce),s=o.konts[t],{form:i,type:u,vals:d}=s;let f,p,m;switch(i){case"addr":{const{func:e,env:n,konts:a}=s;f=r.a.createElement(sa,null,r.a.createElement(Vn,{kontId:t}),r.a.createElement(ia,{label:"Form"},i),r.a.createElement(ia,{label:"Function"},o.funcs[e].form),r.a.createElement(Hn,{envId:n})),m=new aa(a);break}case"frame":{const{env:e,instr:t,exprString:n,kont:a}=s,c=o.instr[t].exprStrings.join(", ");f=r.a.createElement(sa,null,r.a.createElement(ia,{label:"Type"},u),r.a.createElement(Hn,{envId:e}),r.a.createElement(ia,{label:"Instrumentation"},`[ ${c} ]`)),p=r.a.createElement(st.a,null,n),m=new aa([a]);break}default:f=r.a.createElement(sa,null,r.a.createElement(Vn,{kontId:t}),r.a.createElement(ia,{label:"Form"},i))}const h={style:{flex:"1 0 0",backgroundColor:n?a.palette.select.light:void 0,cursor:m?"pointer":void 0,minWidth:100}};let E,y;return m&&(h.classes={root:c.enableHover},h.onClick=n?()=>e.onUnset(t):()=>e.onSet(t,m)),p&&(E=r.a.createElement(ua,null,p)),d&&(y=d.map((e,t)=>{const n=e.map(e=>r.a.createElement(qn,{key:e,valId:e}));return r.a.createElement("div",{key:t,style:{flex:"1 1 auto"}},n)})),r.a.createElement(xn.a,ra({key:t},h),r.a.createElement(In.a,{style:{padding:8}},r.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap"}},f,E),r.a.createElement("div",{style:{display:"flex"}},y)))}function sa(e){const{children:t}=e,n=r.a.Children.map(t,e=>r.a.cloneElement(e,{style:{marginRight:"5px"}}));return r.a.createElement("div",null,n)}function ia(e){const{label:t,children:n,style:a}=e;return r.a.createElement(St.a,{title:t},r.a.createElement(st.a,ra({display:"inline"},{style:a}),n))}function ua(e){const{children:t,classes:n}=e,[c,o]=Object(a.useState)(void 0);return r.a.createElement(a.Fragment,null,r.a.createElement(St.a,{title:"Show info"},r.a.createElement(gt.a,{size:"small",onClick:function(e){e.stopPropagation(),o(e.currentTarget)}},r.a.createElement(na.a,null))),r.a.createElement(ta.a,{open:Boolean(c),anchorEl:c,onClose:function(e){e.stopPropagation(),o(void 0)},classes:{paper:n.paper}},t))}la=Object(Ln.a)(e=>({enableHover:{"&:hover":{backgroundColor:`${e.palette.hover.light} !important`}}}),{withTheme:!0})(la),ua=Object(Ln.a)({paper:{padding:"1em"}})(ua);var da=function(){const{konts:e}=Object(l.d)(ke);return r.a.createElement(Kt,{label:"Stacks",panels:e,onGenerate:function([e,t]){return r.a.createElement(Gn,{key:e,panelId:e,panelType:"konts",onMouseOver:()=>{},onMouseOut:()=>{},disableSelect:!0,disableSelectMsg:"No action"},r.a.createElement(ca,{kontId:e}))}})};function fa(){const e=Object(l.d)(se);let t=r.a.createElement(Lt,{status:"Downloading"});return e.items&&(t=r.a.createElement(Zt,{vertical:!0},r.a.createElement(Ft,{width:"40%"},r.a.createElement(gn,null)),r.a.createElement(Ft,null,r.a.createElement(Zt,{horizontal:!0},r.a.createElement(Ft,{height:"48%"},r.a.createElement(Zt,{vertical:!0},r.a.createElement(Ft,{width:"48%",overflow:"auto"},r.a.createElement(Cn,null)),r.a.createElement(Ft,null,r.a.createElement(da,null)))),r.a.createElement(Ft,{overflow:"auto"},r.a.createElement(Zt,null,r.a.createElement(Ft,{width:"50%",overflow:"auto"},r.a.createElement(Xn,null)),r.a.createElement(Ft,{overflow:"auto"},r.a.createElement(Zn,null)))))))),t}var pa=function(){const e=Object(l.d)(te),t=Object(l.d)(oe),n=Object(l.c)(),c=Object(a.useRef)(void 0);async function o(){await n(function(e){return async function(t){const n=q.getState(),a=oe(n,e),r=se(n,e);let c=!1;switch(a){case T:r.code||t(nt(e));break;case $:await t(rt(e)),c=oe(q.getState(),e)===$;break;case P:r.items||(await t(rt(e)),t(He(e)));break;case R:r.error||await t(rt(e))}return c}}(e))&&(c.current=setTimeout(o,1e3))}let s;switch(Object(a.useEffect)(()=>(o(),()=>{clearTimeout(c.current)}),[]),Object(a.useEffect)(()=>{switch(t){case $:o()}},[t]),t){case I:case T:s=r.a.createElement(sn,{edit:!0});break;case $:s=r.a.createElement(Lt,{status:"Processing"});break;case P:s=r.a.createElement(fa,null);break;case R:s=r.a.createElement(sn,{error:!0})}return s},ma=n(91),ha=n.n(ma),Ea=n(92),ya=n.n(Ea),ga=n(41),va=n.n(ga),ba=n(69),ja=n.n(ba),Oa=n(70),ka=n.n(Oa);var wa=ha()({palette:{secondary:{light:va.a[300],main:va.a[500],dark:va.a[700]},select:{light:va.a[100],main:va.a[400]},hover:{light:ja.a[100],main:ja.a[400]},suggest:{main:ka.a[400],dark:ka.a[700]},warn:{main:ya.a.A700,contrastText:"#fff"}}}),Sa=n(231),Ca=n(220),xa=n(221);var Ia=Object(l.b)(e=>{const t=Oe(e);return{projectId:t,name:t?re(e,t).name:""}},{rename:function(e,t){return async function(n){const a=X(q.getState());return n(qe(e,{name:t})),fetch(`/api/${a}/projects/${e}/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t})})}},setRenameDialog:$e})((function(e){const{projectId:t,name:n,rename:c,setRenameDialog:o}=e,[l,s]=Object(a.useState)(void 0);function i(){o(void 0)}return Object(a.useEffect)(()=>s(n||""),[n]),r.a.createElement(Sa.a,{open:Boolean(t),onClose:i},r.a.createElement(Ca.a,null,r.a.createElement(ft.a,{label:"name",value:l,onChange:e=>s(e.target.value),placeholder:`project ${t} name`})),r.a.createElement(xa.a,null,r.a.createElement(it.a,{onClick:i},"cancel"),r.a.createElement(it.a,{onClick:()=>{i(),c(t,l)}},"rename")))})),Ta=n(227),$a=n(93),Pa=n.n($a);var Ra=function(){const e=Object(l.d)(je),t=Object(l.c)(),[n,c]=Object(a.useState)(void 0);function o(){clearTimeout(n),t(Te())}return Object(a.useEffect)(()=>{e&&c(setTimeout(()=>{o()},2e4))},[e]),r.a.createElement(Ta.a,{open:Boolean(e),onClose:function(e,t){"clickaway"!==t&&o()},action:[r.a.createElement(gt.a,{key:"close",onClick:o,color:"inherit"},r.a.createElement(Pa.a,null))],autoHideDuration:2e4,message:e,anchorOrigin:{horizontal:"left",vertical:"bottom"}})};var Aa=function(){const e=Object(l.d)(Z),t=Object(l.d)(ee),n=Object(l.d)(te),c=Object(l.c)();let o,s,i;switch(e){case S:o=r.a.createElement(pt,null);break;case C:s=r.a.createElement(_a,null),i=r.a.createElement(a.Fragment,null,r.a.createElement(Ua,null),r.a.createElement(La,{content:"new project",onClick:()=>c(et())}),r.a.createElement(Na,null)),o=r.a.createElement(nn,null);break;case x:s=r.a.createElement(_a,null),i=r.a.createElement(a.Fragment,null,r.a.createElement(La,{content:"fork project",onClick:()=>c(tt(n))}),r.a.createElement(La,{content:"export project",onClick:()=>c(ct(n))}),r.a.createElement(Na,null)),o=r.a.createElement(pa,null)}const u=r.a.createElement(ot.a,{position:"static"},r.a.createElement(lt.a,null,s,r.a.createElement(st.a,{variant:"h6",color:"inherit",style:{flex:"1 1 auto",overflow:"hidden",textOverflow:"ellipsis",textAlign:"center"}},t),i));return r.a.createElement(ut.a,{theme:wa},r.a.createElement(Da,null),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"}},!1,u,o,r.a.createElement(Ra,null),r.a.createElement(Ia,null)))};function Da(){return r.a.createElement("div",{style:{display:"flex",height:"100%",width:"100%",position:"fixed",justifyContent:"flex-end",alignItems:"flex-end",pointerEvents:"none",zIndex:-1}},r.a.createElement(st.a,{variant:"caption",color:"textSecondary",style:{padding:5}},"0.3.5"))}function Ma(e){const{content:t,theme:n}=e;return r.a.createElement(st.a,{style:{display:"flex",justifyContent:"center",backgroundColor:n.palette.warn.main,color:n.palette.warn.contrastText}},t)}function _a(){const e=Object(l.c)();return r.a.createElement(La,{content:"project list",onClick:()=>e(Ye(void 0))})}function Na(){const e=Object(l.c)();return r.a.createElement(La,{content:"logout",onClick:t=>e(function(e){return e=>{e(K(void 0)),e(Qe())}}())})}function Ua(){const e=Object(a.useRef)(void 0),t=Object(l.c)();function n(n){const a=new FileReader;a.onload=()=>{const e=JSON.parse(a.result),r=n.name,c=r.match(/aam-vis-(.*)\.json/);if(c){const n=c[1];t(function(e,t){return n=>{t.status=P,n(Ve(e)),n(qe(e,t)),n(He(e))}}(n,e))}else t(Ie(`'${r}' file name incorrectly formatted ('aam-vis-<projectId>.json')`))},a.readAsText(n),e.current.value=""}return r.a.createElement(a.Fragment,null,r.a.createElement(La,{content:"import",onClick:()=>e.current.click()}),r.a.createElement("input",{ref:e,onChange:()=>n(e.current.files[0]),type:"file",hidden:!0}))}function La(e){const{content:t,onClick:n}=e;return r.a.createElement(it.a,{onClick:n,color:"inherit",variant:"outlined",style:{margin:wa.spacing(1)}},t)}Ma=Object(dt.a)(Ma);n(141);o.a.render(r.a.createElement(l.a,{store:q},r.a.createElement(Aa,null)),document.getElementById("app"))}});