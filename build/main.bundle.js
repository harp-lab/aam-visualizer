!function(e){function t(t){for(var a,o,l=t[0],s=t[1],i=t[2],d=0,f=[];d<l.length;d++)o=l[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&f.push(r[o][0]),r[o]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);for(u&&u(t);f.length;)f.shift()();return c.push.apply(c,i||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],a=!0,l=1;l<n.length;l++){var s=n[l];0!==r[s]&&(a=!1)}a&&(c.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},r={0:0},c=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var l=window.webpackJsonp=window.webpackJsonp||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var i=0;i<l.length;i++)t(l[i]);var u=s;c.push([148,1]),n()}({144:function(e,t,n){var a=n(145);"string"==typeof a&&(a=[[e.i,a,""]]);var r={insert:"head",singleton:!1};n(147)(a,r);a.locals&&(e.exports=a.locals)},145:function(e,t,n){(t=e.exports=n(84)(!1)).i(n(146),""),t.push([e.i,"body{margin:0}#app{height:100vh}.CodeMirror{height:100%}.CodeMirror .mark{color:#3f51b5;cursor:pointer;font-size:0.6rem;line-height:inherit;padding-right:2px;vertical-align:top}.CodeMirror .mark:hover{color:#7986cb}.CodeMirror .selected{background-color:#fff59d}\n",""])},148:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(9),o=n.n(c),l=n(6),s=n(30);const i="SET_USER",u="SET_TITLE",d="ADD_PROJECT",f="SET_PROJECT_DATA",m="SET_METADATA",p="SET_STATUS",h="SET_GRAPH_METADATA",E="ADD_PANEL",y="SET_PANEL",g="SET_PANELS",v="REFRESH_PANELS",b="DEL_PROJECT",j="DEL_PROJECTS",O="SEL_PROJECT",k={snackbars:[],dialogs:{},loading:!1};var w=function(e=k,t){switch(t.type){case"QUEUE_SNACKBAR":{const{text:n}=t.payload,{snackbars:a}=e;return{...e,snackbars:[...a,n]}}case"DEQUEUE_SNACKBAR":{const{snackbars:t}=e;t.shift();return{...e,snackbars:[...t]}}case"SET_LOADING":{const{loading:n}=t.payload;return{...e,loading:n}}case"SET_DIALOG":{const{dialogId:n,data:a}=t.payload,{dialogs:r}=e;return{...e,dialogs:{...r,[n]:a}}}default:return e}};const S="LOGIN_VIEW",I="LIST_VIEW",C="PROJECT_VIEW",x="empty",T="edit",$="process",P="done",R="error",A="configs",M="envs",D="stacks",_="frame",N="cstack";function U(e={},t){switch(t.type){case h:{const{graphId:n,data:a}=t.payload,r=e[n];return{...e,[n]:{...r,...a}}}default:return e}}function L(e,t){return(n,a)=>{const r=void 0===n;return t(a)||r?e(n,a):n}}function F(e={},t){switch(t.type){case E:{const{panelId:n,label:a}=t.payload;return{...e,[n]:{label:a,saved:!1,hidden:!0,selected:!1}}}case y:{const{panelId:n,data:a}=t.payload,r=e[n];return{...e,[n]:{...r,...a}}}case g:{const{data:e}=t.payload;return{...e}}case v:{const{func:n}=t.payload,a={};for(const[t,r]of Object.entries(e)){const e=n(t,r);a[t]={...r,...e}}return a}default:return e}}const z=Object(s.c)({configs:L(F,e=>!!e.payload&&e.payload.type===A),envs:L(F,e=>!!e.payload&&e.payload.type===M),stacks:L(F,e=>!!e.payload&&e.payload.type===D)});function B(e={},t){switch(t.type){case p:{const{data:n}=t.payload;return{...e,...n}}default:return e}}var G=function(e={},t){switch(t.type){case m:{const{data:n}=t.payload;return{...e,...n}}default:{const{graphs:n,panels:a,status:r}=e;return{...e,graphs:U(n,t),panels:z(a,t),status:B(r,t)}}}};const J={status:"empty",code:"",metadata:G(void 0,{type:"INIT"})};var H=function(e=J,t){switch(t.type){case f:{const{data:n}=t.payload;return{...e,...n}}default:{const{metadata:n}=e;return{...e,metadata:G(n,t)}}}};var W=function(e={},t){switch(t.type){case d:case f:default:if(t.payload&&t.payload.projectId){const{projectId:n}=t.payload,a=e[n];return{...e,[n]:H(a,t)}}return e;case b:{const{projectId:n}=t.payload,{[n]:a,...r}=e;return{...r}}case j:return{}}};var V=function(e={},t){switch(t.type){case i:{const{userId:n}=t.payload;return{...e,userId:n}}case u:{const{title:n}=t.payload;return{...e,title:n}}case O:{const{projectId:n}=t.payload;return{...e,selectedProjectId:n}}default:{const{notifications:n,projects:a}=e;return{...e,notifications:w(n,t),projects:W(a,t)}}}},q=n(87);const K=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||s.d;var Q=Object(s.e)(V,K(Object(s.a)(q.a)));const Y=e=>({type:i,payload:{userId:e}});const X=e=>({type:u,payload:{title:e}});function Z(e){return e}function ee(e){return Z(e).userId}function te(e){const t=ee(e),n=ae(e);return t?n?C:I:S}function ne(e){return Z(e).title}function ae(e){return Z(e).selectedProjectId}function re(e){return e.projects}function ce(e){return Object.keys(re(e))}function oe(e,t){return t||(t=ae(e)),re(e)[t]}function le(e,t){const{items:n}=oe(e,t);return n}function se(e,t){const{status:n}=oe(e,t);return n}function ie(e,t){return oe(e,t).metadata}function ue(e,t){const{code:n,items:a,error:r}=oe(e,t);return{code:""!==n,items:Boolean(a),error:Boolean(r)}}function de(e){return le(e).graphs}function fe(e){return ie(e).mainGraphId||"funcs"}function me(e){const t=ye(e,fe(e));let n="states";if(t.length>0){const a=t[0],r=le(e),{form:c}=r.funcs[a];["halt","not found","non-func","unknown"].includes(c)||(n=a)}return n}function pe(e){const t=fe(e);return ie(e).focusedGraph||t}function he(e,t){return de(e)[t]}function Ee(e,t){return function(e){return ie(e).graphs}(e)[t]||{}}function ye(e,t){return Ee(e,t).selectedNodes||[]}function ge(e,t){const n=le(e);switch(t){case"funcs":return n.funcs;case"states":default:return n.configs}}function ve(e){return[fe(e),me(e)].flatMap(t=>{return je(ye(e,t),ge(e,t))})}function be(e){return[fe(e),me(e)].flatMap(t=>{return je(function(e,t){return Ee(e,t).hoveredNodes||[]}(e,t),ge(e,t))})}function je(e,t){const n=new Set;if(t)for(const a of e){const{astLink:e,expr:r}=t[a];let c=[];e?c=e:r&&(c=[r]),c.forEach(e=>n.add(e))}return[...n]}function Oe(e){return e.notifications}function ke(e){const{snackbars:t}=Oe(e);return t[0]}function we(e){return function(e,t){const{dialogs:n}=Oe(e);return n[t]}(e,"rename")}function Se(e){return ie(e).panels}function Ie(e,t){const n=ae(Q.getState());return{type:h,payload:{projectId:n,graphId:e,data:t}}}function Ce(e,t){return n=>{const a=ye(Q.getState(),e),r=new Set([...a,...t]);n(Ie(e,{selectedNodes:[...r]})),n(Je())}}function xe(e,t){return Ie(e,{hoveredNodes:t})}function Te(e,t){return n=>{n(Ie(e,{selectedEdges:t}));const a=Q.getState(),{graph:r}=he(a,e),c=fe(a),o=new Set;for(const e of t){const[t,n]=e.split("-"),a=r[t][n],{calls:c}=a;if(c)for(const e of c)o.add(e)}n(function(e,t){return Ie(e,{suggestedNodes:t})}(c,[...o]))}}const $e=e=>({type:"QUEUE_SNACKBAR",payload:{text:e}}),Pe=()=>({type:"DEQUEUE_SNACKBAR"}),Re=e=>({type:"SET_DIALOG",payload:{dialogId:"rename",data:e}});function Ae(e,t,n){const a=ae(Q.getState());return{type:y,payload:{projectId:a,type:e,panelId:t,data:n}}}function Me(e,t,n){return{type:g,payload:{projectId:e,type:t,data:n}}}const De=(e,t)=>Ae(e,t,{hidden:!0}),_e=(e,t)=>Ae(e,t,{hidden:!1}),Ne=(e,t)=>Ae(e,t,{saved:!0}),Ue=(e,t)=>Ae(e,t,{saved:!1}),Le=(e,t)=>Ae(e,t,{selected:!0}),Fe=(e,t)=>Ae(e,t,{selected:!1});function ze(e,t){return`${t}-${e}`}const Be=e=>_e(M,e);function Ge(e,t){const n=ae(Q.getState());return{type:v,payload:{projectId:n,type:e,func:t}}}function Je(){return e=>{e(function(){const e=Q.getState(),t=me(e),n=ye(e,t);return Ge(A,(e,t)=>n.includes(e)?{selected:!0,hidden:!1}:{hidden:!0})}()),e(He()),e(We())}}function He(){const e=Q.getState(),t=le(e),{configs:n}=Se(e),a=[];for(const[e,r]of Object.entries(n))if(!r.hidden&&r.selected){const n=t.configs[e].states;if(n)for(const e of n){const n=t.states[e].env;n&&a.push(n)}}return Ge(M,(e,t)=>a.includes(e)?{hidden:!1}:{hidden:!0})}function We(){const e=Q.getState(),t=le(e),{configs:n}=Se(e),a=[];for(const[e,r]of Object.entries(n))if(!r.hidden&&r.selected){const n=t.configs[e].states;if(n)for(const e of n){const n=t.states[e],{[_]:r,[N]:c}=n,o=ze(r||c,r?_:N);a.push(o)}}return Ge(D,(e,t)=>a.includes(e)?{hidden:!1}:{hidden:!0})}function Ve(e){return t=>{const n=le(Q.getState(),e);n.configs&&t(function(e){return t=>{const n=le(Q.getState(),e),a={};for(const[e,t]of Object.entries(n.configs)){const{form:r,states:c}=t;let o;if(c){const e=c[0],t=n.states[e];switch(t.form){case"halt":if(t.results){o=`[ ${t.results.map(e=>{const{type:t,name:a,valString:r}=n.vals[e];let c;switch(t){case"closure":c=a;break;case"bool":c=r}return c}).join(", ")} ]`}break;default:o=t.exprString}}const l=`${e}: ${r} - ${o}`;a[e]=qe(l)}t(Me(e,A,a))}}(e)),n.envs&&t(function(e){return t=>{const n=le(Q.getState(),e),a={};for(const[e,t]of Object.entries(n.envs)){const n=`${e}: [ ${t.map(e=>e.varString).join(", ")} ]`;a[e]=qe(n)}t(Me(e,M,a))}}(e)),(n.frames||n.cstacks)&&t(function(e){return t=>{const n=le(Q.getState(),e),a={};if(n.frames)for(const[e,t]of Object.entries(n.frames)){const{descs:n}=t;let r=`${e}: `;n.length>1?r+=`[ ${n[0]}, ... +${n.length-1} ]`:r+=`[ ${n[0]} ]`,a[ze(e,_)]={...qe(r),frame:e}}if(n.cstacks)for(const[e,t]of Object.entries(n.cstacks)){let t=`${e}`;a[ze(e,N)]={...qe(t),cstack:e}}t(Me(e,D,a))}}(e))}}function qe(e){return{label:e,saved:!1,hidden:!0,selected:!1}}const Ke=e=>({type:d,payload:{projectId:e}}),Qe=(e,t)=>({type:f,payload:{projectId:e,data:t}}),Ye=e=>({type:b,payload:{projectId:e}}),Xe=()=>({type:j});function Ze(e){return t=>{if(e){const n=Q.getState(),{name:a}=oe(n,e);t(X(a||e))}t({type:O,payload:{projectId:e}})}}const et=(e,t)=>({type:m,payload:{projectId:e,data:t}});function tt(e,t){const n=ee(Q.getState());return fetch(`/api/${n}/${e}`,{method:t})}function nt(){return async function(e){const t=await tt("create","GET"),n=(await t.json()).id;return e(Ke(n)),e(Ze(void 0)),n}}function at(e){return async function(t){let n=Q.getState(),a=oe(n,e);a.status!==x&&(await t(rt(e)),a=oe(n=Q.getState(),e));const r=await t(nt()),{code:c,analysis:o}=a;t(Qe(r,{code:c,analysis:o})),t(Ze(r))}}function rt(e){return async function(t){const n=await tt(`projects/${e}/code`,"GET"),{code:a}=await n.json();t(Qe(e,{code:a}))}}function ct(e,t){return n=>{const a=Q.getState(),{userId:r,status:c}=oe(a,e);switch(c){case x:case T:{let a=T;return""==t&&(a=x),n(Qe(e,{status:a,code:t})),fetch(`/api/${r}/projects/${e}/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:t})})}}}}function ot(e){return async function(t){const n=await tt(`projects/${e}/data`,"GET");switch(n.status){case 200:{const a=await n.json();return t(Qe(e,a)),n.status}case 204:return n.status;case 412:return t($e("Project data request rejected")),n.status}}}function lt(e){return async function(t){switch(await t(ot(e))){case 200:{const t=oe(Q.getState(),e),n={};for(const[e,a]of Object.entries(t))["analysis","code","items"].includes(e)&&(n[e]=a);const a=JSON.stringify(n,null,2),r=new Blob([a],{type:"application/json"}),c=URL.createObjectURL(r),o=`aam-vis-${e}.json`,l=document.createElement("a");Object.assign(l,{href:c,download:o}),document.body.appendChild(l),l.click(),l.remove(),URL.revokeObjectURL(c);break}case 204:t($e("Project still processing"))}}}var st=n(226),it=n(208),ut=n(49),dt=n(196),ft=n(227),mt=n(209),pt=n(229);var ht=function(){const e=Object(l.c)(),[t,n]=Object(a.useState)("guest"),c=!/^\w+$/.test(t);return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%",justifyContent:"center",alignContent:"center",alignItems:"center"}},r.a.createElement(pt.a,{label:"username",value:t,onChange:e=>n(e.target.value),error:c,helperText:"You can use letters, numbers, & underscores"}),r.a.createElement(dt.a,{onClick:()=>e(function(e){return t=>{t(Y(e))}}(t)),disabled:c},"login"))},Et=n(195),yt=n(150),gt=n(210),vt=n(211),bt=n(151),jt=n(92),Ot=n.n(jt),kt=n(90),wt=n.n(kt),St=n(91),It=n.n(St),Ct=n(234),xt=n(99),Tt=n(197),$t=n(89),Pt=n.n($t);var Rt=function(e){const{items:t}=e,[n,c]=Object(a.useState)(void 0);function o(){c(void 0)}const l=t.map(e=>{const{label:t,callback:n}=e;return r.a.createElement(Tt.a,{key:t,onClick:()=>{o(),n()}},t)});return r.a.createElement(a.Fragment,null,r.a.createElement(Ct.a,{title:"More"},r.a.createElement(bt.a,{color:"inherit",onClick:function(e){c(e.currentTarget)}},r.a.createElement(Pt.a,null))),r.a.createElement(xt.a,{anchorEl:n,getContentAnchorEl:void 0,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},open:Boolean(n),onClose:o},l))},At=n(198);var Mt=function(e){const{item:t}=e,{debug:n}=t;if(!n)return null;let a;return a=n instanceof String?r.a.createElement(ut.a,null,n):n instanceof Array?n.map((e,t)=>r.a.createElement(ut.a,{key:t},e)):r.a.createElement(ut.a,null,"Invalid debug property type: ",typeof n),r.a.createElement(Lt,{icon:r.a.createElement(At.a,null),tooltip:"Show debug"},a)};class Dt extends a.Component{constructor(e){super(e),this.state={error:!1}}static getDerivedStateFromError(e){return{error:!0}}componentDidCatch(e,t){}render(){return this.state.error?r.a.createElement(qt,{content:"Error caught"}):this.props.children}}var _t=Dt,Nt=n(193),Ut=n(152);var Lt=Object(Ut.a)({paper:{padding:"1em"}})((function(e){const{icon:t,tooltip:n,children:c,classes:o}=e,[l,s]=Object(a.useState)(void 0);return r.a.createElement(a.Fragment,null,r.a.createElement(Ct.a,{title:n},r.a.createElement(bt.a,{size:"small",onClick:function(e){e.stopPropagation(),s(e.currentTarget)}},t)),r.a.createElement(Nt.a,{open:Boolean(l),anchorEl:l,onClose:function(e){e.stopPropagation(),s(void 0)},classes:{paper:o.paper}},c))})),Ft=n(199);function zt(){return(zt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var Bt=function(e){const{content:t,tooltip:n,onClick:a,style:c}=e;return r.a.createElement(Ct.a,{title:n},r.a.createElement(Ft.a,zt({onClick:e=>{e.stopPropagation(),a()}},{style:c}),r.a.createElement(ut.a,{display:"inline",style:{cursor:"pointer"}},t)))},Gt=n(200),Jt=n(201),Ht=n(202);var Wt=function(e){const{status:t,variant:n="circular"}=e;let a;switch(n){case"circular":a=r.a.createElement(Vt,{style:{justifyContent:"center",alignItems:"center"}},r.a.createElement(Gt.a,{in:!0,style:{transitionDelay:"1000ms"}},r.a.createElement(Jt.a,null)),r.a.createElement(Gt.a,{in:!0,style:{transitionDelay:"200ms"}},r.a.createElement(ut.a,{variant:"h6",style:{marginTop:"2em"}},t)));break;case"linear":a=r.a.createElement(Vt,null,r.a.createElement(Ht.a,null),r.a.createElement(ut.a,{variant:"h6",style:{flex:"1 1 auto",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},this.props.status))}return a};var Vt=function(e){const{overflow:t,children:n,style:c}=e,o=Object(a.useContext)(ln),{height:l,width:s}=o;return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",height:l||"100%",width:s||"100%",overflow:t||"hidden",...c}},r.a.createElement(_t,null,n))};var qt=function(e){const{content:t}=e;return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%",justifyContent:"center",alignItems:"center"}},r.a.createElement(ut.a,{variant:"h6"},t))},Kt=n(205),Qt=n(206),Yt=n(207),Xt=n(204),Zt=n(203);var en=function(e){const t=e.labels.map(e=>r.a.createElement(Zt.a,{key:e},e)),n=e.entries.map((e,t)=>{const n=e.map((e,t)=>r.a.createElement(Zt.a,{key:t},e));return r.a.createElement(Xt.a,{key:t},n)});return r.a.createElement(Kt.a,{size:"small"},r.a.createElement(Qt.a,null,r.a.createElement(Xt.a,null,t)),r.a.createElement(Yt.a,null,n))};function tn(e){const t=e.theme;return r.a.createElement(it.a,{variant:"dense",style:{backgroundColor:t.palette.secondary.main,color:t.palette.secondary.contrastText,minHeight:"auto"}},r.a.createElement(ut.a,null,e.content))}tn=Object(mt.a)(tn);var nn=function(e){const{label:t,panels:n}=e,c=[...Object.entries(n).filter(([t,n])=>{const{saved:a}=n,r=a;let c=!0;return e.onFilterSaved&&(c=e.onFilterSaved([t,n])),r&&c}).map(e.onGenerate),...Object.entries(n).filter(([t,n])=>{const{saved:a,hidden:r}=n,c=!a&&!r;let o=!0;return e.onFilterUnsaved&&(o=e.onFilterUnsaved([t,n])),c&&o}).map(e.onGenerate)];return r.a.createElement(a.Fragment,null,r.a.createElement(tn,{content:t}),r.a.createElement("div",{style:{overflowY:"auto"}},c))};var an=function(e){const{children:t,childrenStyle:n}=e,a=r.a.Children.map(t,e=>{if(e)return r.a.cloneElement(e,{style:n})});return r.a.createElement("div",null,a)};function rn(){return(rn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function cn(e){const{horizontal:t,onMouseDown:n}=e;let a;return a=t?{height:5,cursor:"ns-resize"}:{width:5,cursor:"ew-resize"},r.a.createElement("div",{style:{backgroundColor:"darkgray",...a},onMouseDown:n})}var on=function(e){const{horizontal:t,children:n}=e,c=Object(a.useRef)(void 0),[o,l]=Object(a.useState)(!1),s=n[0].props,i=parseInt(s.width||s.height),[u,d]=Object(a.useState)(i);function f(){o&&l(!1)}let m,p,h;t?(m="height",p="horizontal",h="ns-resize"):(m="width",p="vertical",h="ew-resize");const[E,y]=n;return r.a.createElement("div",{ref:c,style:{display:"flex",flexDirection:t?"column":"row",flex:"1 1 auto",cursor:o?h:"default",minHeight:0},onMouseMove:function(e){if(o){!function(){const e=window.getSelection();e&&e.removeAllRanges()}();const n=c.current.getBoundingClientRect();let a;a=t?(e.clientY-n.y)/n.height*100:(e.clientX-n.x)/n.width*100,d(a)}},onMouseUp:f,onMouseLeave:f},r.a.createElement(ln.Provider,{value:{[m]:`${u}%`}},E),r.a.createElement(cn,rn({[p]:!0},{onMouseDown:function(){l(!0)}})),r.a.createElement(ln.Provider,{value:{[m]:`${100-u}%`}},y))},ln=r.a.createContext({});function sn(e){const{projectId:t}=e,n=Object(l.d)(e=>oe(e,t)),a=Object(l.c)(),c=r.a.createElement(gt.a,{style:{flex:"0 0 10em"}},n.analysis),o=r.a.createElement(gt.a,{style:{overflow:"hidden",textOverflow:"ellipsis"}},n.name||"unnamed"),s=r.a.createElement(gt.a,{style:{flex:"0 0 10em"}},t),i=r.a.createElement(gt.a,{style:{flex:"0 0 10em"}},n.status);let u;u=n.status==$?r.a.createElement(Ct.a,{title:"Cancel processing"},r.a.createElement(bt.a,{onClick:()=>a(function(e){return async function(t){switch((await tt(`projects/${e}/cancel`,"POST")).status){case 200:t(Qe(e,{status:T}));break;case 409:t($e(`Project ${e} cancel request denied - already finished`));break;default:t($e(`Project ${e} cancel request failed`));break}}}(t))},r.a.createElement(wt.a,null))):r.a.createElement(Ct.a,{title:"Delete"},r.a.createElement(bt.a,{onClick:()=>a(function(e){return async function(t){const n=ae(Q.getState());switch((await tt(`projects/${e}/delete`,"POST")).status){case 205:t(Ye(e)),n==e&&t(Ze(void 0));break;default:t($e(`Project ${e} delete request failed`))}}}(t))},r.a.createElement(It.a,null)));const d=r.a.createElement(vt.a,null,r.a.createElement(Rt,{items:[{label:"Rename",callback:()=>a(Re(t))},{label:"Export",callback:()=>a(lt(t))}]}),r.a.createElement(Ct.a,{title:"Fork"},r.a.createElement(bt.a,{onClick:()=>a(at(t))},r.a.createElement(Ot.a,null))),u);return r.a.createElement(yt.a,{button:!0,key:t,onClick:()=>a(Ze(t)),align:"flex-start",style:{paddingRight:160}},c,o,s,i,d)}var un=function(){const e=Object(l.d)(ce),t=Object(l.c)(),n=Object(a.useRef)(void 0);async function c(){await t((async function(e){const t=await tt("all","GET");let n=!1;switch(t.status){case 200:{const a=await t.json();for(const[t,r]of Object.entries(a)){const{status:a,name:c,analysis:o}=r;e(Qe(t,{status:a,name:c,analysis:o})),a===$&&(n=!0)}break}default:n=!0}return n}))&&(n.current=setTimeout(c,1e3))}Object(a.useEffect)(()=>(c(),()=>{clearTimeout(n.current)}),[]);const o=e.map(e=>r.a.createElement(sn,{key:e,projectId:e}));return r.a.createElement(Et.a,{style:{overflowY:"auto"}},o)},dn=n(233),fn=n(228),mn=n(59),pn=n.n(mn);n(122);function hn(e){const{onClick:t}=e;return r.a.createElement(dt.a,{onClick:t,variant:"contained",color:"secondary"},"process")}var En=function(e){const{edit:t,error:n}=e,c=["0-cfa","1-cfa","2-cfa"],o=Object(a.useRef)(void 0),s={lineWrapping:!0,lineNumbers:!0,readOnly:!t},i=Object(a.useRef)(pn.a),[u,d]=Object(a.useState)({analysis:c[0]}),f=Object(l.d)(ae),{code:m,error:p}=Object(l.d)(oe),h=Object(l.c)();function E(){return i.current.getDoc().getValue()}let y,g;if(Object(a.useEffect)(()=>(i.current=pn.a.fromTextArea(o.current,s),()=>{i.current.toTextArea(),h(ct(f,E()))}),[]),Object(a.useEffect)(()=>{!function(e){i.current.getDoc().setValue(e)}(m)},[m]),t){y=r.a.createElement(ut.a,null,"Input code for analysis");const e=c.map(e=>r.a.createElement(Tt.a,{key:e,value:e},e));g=r.a.createElement(it.a,null,r.a.createElement("div",{style:{flex:"1 1 auto"}},r.a.createElement(dn.a,null,"Analysis"),r.a.createElement(fn.a,{value:u.analysis,onChange:e=>{const t=e.target.value;d({...u,analysis:t})}},e)),r.a.createElement(hn,{onClick:function(){h(function(e,t,n){return async function(a){await a(ct(e,t));const r=Q.getState(),{userId:c}=oe(r,e);switch((await fetch(`/api/${c}/projects/${e}/process`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).status){case 200:a(Qe(e,{status:"process"}));break;case 412:a($e("Project process request rejected"))}}}(f,E(),u))}}))}else n&&(y=r.a.createElement(a.Fragment,null,r.a.createElement(ut.a,{variant:"h3"},"Analysis error"),r.a.createElement(ut.a,null,p)));return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"auto"}},y,r.a.createElement("textarea",{ref:e=>o.current=e,style:{flex:"1 1 auto",overflow:"auto",height:"100%"}}),g)},yn=n(93),gn=n.n(yn);var vn=function(e,t){return{group:"nodes",data:{id:e,label:`${e}\n${t}`,form:t}}};var bn=function(e,t,n,a){const{label:r="",style:c}=a;return{group:"edges",data:{id:e,label:r,source:t,target:n,style:c}}};var jn=function(e,t){const n=t.graphs[e],{graph:a,start:r}=n;function c(e,t){const n=[];for(const[a,r]of Object.entries(e)){let e;t&&(e=t[a].form),n.push(vn(a,e));for(const[c,o]of Object.entries(r)){t&&(e=t[c].form),n.push(vn(c,e));const r=`${a}-${c}`;n.push(bn(r,a,c,o))}}return n}switch(e){case"funcs":return c(a,t.funcs);case"states":default:return c(a,t.configs)}};function On(e){const t=Object(a.useRef)(void 0),n=Object(a.useRef)(void 0),c=Object(a.useRef)(!1),{graphId:o,edgePredicate:s,onNodeSelect:i,onNodeUnselect:u,theme:d}=e,f=Object(l.d)(le);if(!f.graphs[o])return r.a.createElement(qt,{content:`'${o}' graph undefined`});const m=jn(o,f),p=Object(l.d)(e=>Ee(e,o)),h=Object(l.d)(pe)===o,E=Object(l.c)(),y={style:[{selector:"node",style:{label:"data(label)","text-wrap":"wrap"}},{selector:"node:selected",style:{"background-color":d.palette.select.main}},{selector:"edge",style:{label:"data(label)","curve-style":"bezier","target-arrow-shape":"triangle","line-style":(g="line-style",v="solid",e=>{const t=e.data("style");let n;return n=t&&t[g]?t[g]:v})}},{selector:"edge:selected",style:{"line-color":d.palette.select.main,"target-arrow-color":d.palette.select.main}},{selector:".suggested",style:{"background-color":d.palette.suggest.main}},{selector:e=>e.hasClass("suggested")&&e.selected(),style:{"background-color":d.palette.suggest.dark}},{selector:".hovered",style:{"background-color":d.palette.hover.main}}],headless:!0};var g,v;const b=Object(a.useRef)(gn()(y)).current,{positions:j,selectedNodes:O=[],selectedEdges:k=[],hoveredNodes:w=[],suggestedNodes:S=[]}=p;function I(e){const t=b.$("node:selected");switch(e.key){case"ArrowLeft":const e=t.incomers().nodes();1==e.length&&(t.unselect(),e.select());break;case"ArrowRight":const n=t.outgoers().nodes();1==n.length&&(t.unselect(),n.select())}}function C(e,t){b.batch(()=>{for(const n of e){b.getElementById(n).addClass(t)}})}function x(e,t){b.batch(()=>{for(const n of e){b.getElementById(n).removeClass(t)}})}return Object(a.useEffect)(()=>(b.mount(t.current),()=>b.unmount()),[]),Object(a.useEffect)(()=>{if(h)return document.addEventListener("keydown",I),()=>{document.removeEventListener("keydown",I)}},[h]),Object(a.useEffect)(()=>(["tap","select","unselect","mouseover","mouseout"].forEach(e=>b.off(e)),b.on("tap",()=>E(function(e){const t=ae(Q.getState());return et(t,{focusedGraph:e})}(o))),b.on("select","node",e=>{if(c.current){const t=e.target.id();E(Ce(o,[t])),i&&i(t)}}),b.on("unselect","node",e=>{if(c.current){const t=e.target.id();E(function(e,t){return n=>{const a=ye(Q.getState(),e),r=new Set(a);t.forEach(e=>r.delete(e)),n(Ie(e,{selectedNodes:[...r]})),n(Je())}}(o,[t])),u&&u(t)}}),b.on("mouseover","node",e=>{const t=e.target.id();w!=[t]&&E(xe(o,[t]))}),b.on("mouseout","node",e=>{E(xe(o,[]))}),b.on("select","edge",e=>{if(c.current){const t=e.target;if(s(t)){const e=t.id();E(Te(o,[e]))}else t.unselect()}}),b.on("unselect","edge",e=>{c.current&&E(Te(o,[]))}),b.add(m),j?(b.nodes().positions(e=>j[e.data("id")]),b.fit()):b.layout({name:"cose",directed:!0}).run(),()=>{const e={};for(const t of m){const n=t.data.id;e[n]=b.$id(n).position()}E(function(e,t){return Ie(e,{positions:t})}(o,e)),b.nodes().remove()}),[o]),Object(a.useEffect)(()=>{return c.current=!1,function(e){e.forEach(e=>b.$id(e).select())}([...O,...k]),c.current=!0,()=>{c.current=!1,function(e){e.forEach(e=>b.$id(e).unselect())}([...O,k]),c.current=!0}},[O,k]),Object(a.useEffect)(()=>(c.current=!1,C(S,"suggested"),c.current=!0,()=>{c.current=!1,x(S,"suggested"),c.current=!0}),[S]),Object(a.useEffect)(()=>(c.current=!1,C(w,"hovered"),c.current=!0,()=>{c.current=!1,x(w,"hovered"),c.current=!0}),[w]),Object(a.useEffect)(()=>{b.resize()},[n.current]),Object(a.useEffect)(()=>{n.current=t.current.getBoundingClientRect()}),r.a.createElement("div",{style:{flex:"1 1 1%",display:"block",minHeight:0,width:"100%"},ref:t})}var kn=On=Object(mt.a)(On);function wn(e){const{content:t,theme:n}=e;return r.a.createElement(it.a,{variant:"dense",style:{backgroundColor:n.palette.grey[300],color:n.palette.text.primary,width:"100%",minHeight:"unset"}},r.a.createElement(ut.a,null,t))}wn=Object(mt.a)(wn);var Sn=function(){const e=Object(l.d)(fe),t=Object(l.d)(me);return r.a.createElement(on,{horizontal:!0},r.a.createElement(Vt,{height:"50%"},r.a.createElement(wn,{content:e}),r.a.createElement(kn,{graphId:e,edgePredicate:e=>!1})),r.a.createElement(Vt,{height:"50%"},r.a.createElement(wn,{content:t}),r.a.createElement(kn,{graphId:t,edgePredicate:e=>{const t=e.data("style");return!!t&&"dashed"===t["line-style"]}})))};var In=class{constructor(e,t){this.line=e,this.ch=t}toString(){return`line ${this.line} ch ${this.ch}`}},Cn=n(69),xn=n.n(Cn);var Tn=class{constructor(e,t){this.start=e,this.end=t,this.nodes={}}addNode(e,t){this.nodes[e]?this.nodes[e].push(t):this.nodes[e]=[t]}in(e,t,n){let a=!1;if(t.line==n.line){const r=t.line<=e.line&&e.line<=n.line,c=t.ch<=e.ch&&e.ch<n.ch;r&&c&&(a=!0)}else{const r=e.line==t.line,c=e.line==n.line,o=t.line<e.line&&e.line<n.line,l=t.ch<=e.ch,s=e.ch<n.ch;(r&&l||o||c&&s)&&(a=!0)}return a}startsIn(e,t){return this.in(this.start,e,t)}endsIn(e,t){return this.in(new In(this.end.line,this.end.ch-1),e,t)}includes(e,t){const n=this.in(e,this.start,this.end),a=this.in(new In(t.line,t.ch-1),this.start,this.end);return n&&a}has(e){return this.in(e,this.start,this.end)}smallerThan(e){const t=this.end.line-this.start.line<e.end.line-e.start.line,n=this.end.ch-this.start.ch<e.end.ch-e.start.ch;return t||!t&&n}coverage(e,t){let n,a;const r=this.includes(e,t);let c;return this.startsIn(e,t)?n=this.start:r&&(n=e),this.endsIn(e,t)?a=this.end:r&&(a=t),c=n&&a?a.ch-n.ch:0}};function $n(e){const{code:t}=Object(l.d)(oe),n=Object(l.d)(fe),c=Object(l.d)(me),o=Object(l.d)(le),s=[];o.graphs[n]&&s.push(n),o.graphs[c]&&s.push(c);const i=Object(l.d)(ve),u=Object(l.d)(be),d=Object(l.c)(),f={};if(o.ast){for(const[e,t]of Object.entries(o.ast)){const{start:n,end:a}=t,r=new In(n[0],n[1]),c=new In(a[0],a[1]);f[e]=new Tn(r,c)}s.forEach(e=>(function(e){const t=function(e){const{graph:t}=o.graphs[e],n=[];for(const[e,a]of Object.entries(t))n.push(e),n.concat(Object.keys(a));return n}(e),n=function(e){switch(e){case"funcs":return o.funcs;case"states":default:return o.configs}}(e);for(const a of t){const t=je([a],n);for(const n of t)f[n].addNode(e,a)}})(e))}const[m,p]=Object(a.useState)("auto"),{theme:h}=e,E=Object.entries(f).reduce((e,t)=>{const[n,a]=t;return Object.keys(a.nodes).length>0&&(e[n]=a),e},{});function y(){for(const e of s)d(xe(e,void 0))}const g=t.split(/\r\n|\n/).map(e=>e.match(/\(|\)|\[|\]|[^\s\(\)\[\]]+|\s+/g)),v=g.map((e,t)=>{let n=0;e||(e=[" "]);const a=e.map((e,a)=>{const c=new In(t,n),o=new In(t,n+e.length);n+=e.length;let l="inherit";e.match(/lambda|let|if|\#t|\#f/)&&(l=xn.a[800]);const s=u.map(e=>E[e]).filter(e=>void 0!==e),f=i.map(e=>E[e]).filter(e=>void 0!==e),m=s.find(e=>e.includes(c,o)),p=f.find(e=>e.includes(c,o));let g=e;m?g=r.a.createElement(Pn,{content:e,color:h.palette.hover.light}):p&&(g=r.a.createElement(Pn,{content:e,color:h.palette.select.light}));const v=function(e,t){const n=new In(e,t);let a;return Object.entries(E).forEach(([e,t])=>{if(t.has(n))if(a){const n=E[a];t.smallerThan(n)&&(a=e)}else a=e}),a}(t,c.ch);return r.a.createElement(Rn,{key:a,content:g,textColor:l,onMouseOver:()=>(function(e){if(y(),e)for(const[t,n]of Object.entries(E[e].nodes))d(xe(t,n))})(v),onClick:()=>(function(e){const t=E[e],n=t.nodes,a=Object.keys(t.nodes).filter(e=>"funcs"!==e);if(a.length>0){const e=a[0],t=n[e];d(Ce(e,t))}})(v),style:{cursor:"pointer"}})}),c=r.a.createElement("div",{style:{display:"inline-block",width:m,fontFamily:'Roboto Mono, "Courier New", Courier, monospace',backgroundColor:h.palette.grey[200],textAlign:"right",padding:"0 5px"}},r.a.createElement(ut.a,{variant:"body2",ref:e=>{const n=t==g.length-1;if(e&&n){const t=e.getBoundingClientRect(),n=t.width;m!==n&&p(t.width)}},color:"textSecondary"},t+1));return r.a.createElement("div",{key:t},c,r.a.createElement(ut.a,{onMouseLeave:()=>y(),variant:"body2",style:{display:"inline-block",verticalAlign:"bottom",fontFamily:'Roboto Mono, "Courier New", Courier, monospace'}},a))});return r.a.createElement("div",{style:{whiteSpace:"pre"}},v)}function Pn(e){const{content:t,color:n}=e;return r.a.createElement(Rn,{content:t,color:n})}function Rn(e){const{content:t,color:n,textColor:a,style:c,onClick:o,onMouseOver:l}=e;return r.a.createElement("span",{onMouseOver:l,onClick:o,style:{display:"inline-block",backgroundColor:n||"inherit",color:a||"inherit",...c}},t)}var An=$n=Object(mt.a)($n),Mn=n(221),Dn=n(222),_n=n(230),Nn=n(218),Un=n(220),Ln=n(212),Fn=n(213),zn=n(214),Bn=n(215),Gn=n(216),Jn=n(217),Hn=n(219);function Wn(){return(Wn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Vn(e){const{panelId:t,panelType:n,children:c,theme:o,classes:s,onSelect:i,onUnselect:u,onMouseOver:d,onMouseOut:f}=e,m=Object(l.d)(Se)[n][t],p=Object(l.c)(),[h,E]=Object(a.useState)(!1);const{label:y,selected:g,saved:v}=m;let b,j;j=e.disableSelect?r.a.createElement(qn,{icon:r.a.createElement(Ln.a,{color:"disabled"}),tooltip:e.disableSelectMsg,disabled:!0}):g?r.a.createElement(qn,{icon:r.a.createElement(zn.a,null),tooltip:"Unselect",onClick:function(){p(Fe(n,t)),u&&u()}}):r.a.createElement(qn,{icon:r.a.createElement(Fn.a,null),tooltip:"Select",onClick:function(){p(Le(n,t)),i&&i()}}),b=v?r.a.createElement(qn,{icon:r.a.createElement(Gn.a,null),tooltip:"Unsave",onClick:()=>p(Ue(n,t))}):r.a.createElement(qn,{icon:r.a.createElement(Bn.a,null),tooltip:"Save",onClick:()=>p(Ne(n,t))});const O=r.a.createElement(qn,{icon:r.a.createElement(Jn.a,null),tooltip:"Delete",onClick:()=>p(De(n,t))});return r.a.createElement(_n.a,{onMouseOver:()=>{h||(d(),E(!0))},onMouseOut:()=>{h&&(f(),E(!1))},defaultExpanded:!v},r.a.createElement(Nn.a,{expandIcon:r.a.createElement(Hn.a,null),classes:{root:s.panelRoot,content:s.panelContent,expandIcon:s.panelExpandIcon,expanded:s.panelExpanded},style:{backgroundColor:h?o.palette.hover.light:void 0}},j,b,O,r.a.createElement(ut.a,null,y)),r.a.createElement(Un.a,null,c))}function qn(e){const{icon:t,tooltip:n,disabled:a,onClick:c}=e,o={};return a?(o.disableRipple=!0,o.onClick=e=>{e.stopPropagation()}):o.onClick=e=>{e.stopPropagation(),c()},r.a.createElement(Ct.a,{title:n},r.a.createElement(bt.a,Wn({size:"small"},o),t))}var Kn=Vn=Object(Ut.a)(e=>({panelRoot:{minHeight:0,"&$panelExpanded":{minHeight:0}},panelContent:{alignItems:"center",margin:"5px 0","&$panelExpanded":{margin:"8px 0"}},panelExpandIcon:{padding:"5px 12px"},panelExpanded:{}}),{withTheme:!0})(Vn);function Qn(){return(Qn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var Yn=function(e){const{envId:t,style:n}=e,a=Object(l.c)();return r.a.createElement(Bt,Qn({content:t,tooltip:"Show environment",onClick:()=>a(Be(t))},{style:n}))};function Xn(){return(Xn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var Zn=function(e){const{stackId:t,stackType:n,style:a}=e,c=Object(l.c)();return r.a.createElement(Bt,Xn({content:t,tooltip:"Show stack",onClick:()=>c(function(e,t){const n=ze(e,t);return _e(D,n)}(t,n))},{style:a}))};var ea=function(e){const{valId:t}=e,n=Object(l.d)(le),{type:a,astString:c,valString:o}=n.vals[t];let s;switch(a){case"bool":s=o;break;case"closure":s=c;break;default:s=`'${a}' value type unsupported`}return r.a.createElement(ut.a,null,s)};function ta(){return(ta=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function na(e){const{configId:t}=e,n=Object(l.d)(le),{states:a}=n.configs[t];let c;return a&&(c=a.map(e=>{const{form:t}=n.states[e];switch(t){case"halt":return;default:return r.a.createElement(aa,{key:e,stateId:e})}})),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%"}},c)}function aa(e){const{stateId:t}=e,n=Object(l.d)(le),{instr:a,frame:c,cstack:o,env:s,vals:i}=n.states[t],u=n.instr[a].exprStrings.join(", "),d=r.a.createElement(ut.a,{display:"inline"},`[ ${u} ]`),f=c||o,m=c?_:N,p=r.a.createElement(Zn,ta({stackId:f},{stackType:m})),h=s?r.a.createElement(Yn,{envId:s}):void 0;let E;return i&&(E=i.map((e,t)=>{const n=e.map(e=>r.a.createElement(ea,{key:e,valId:e}));return r.a.createElement("div",{key:t,style:{flex:"1 1 auto"}},n)})),r.a.createElement(Mn.a,{style:{width:"100%"}},r.a.createElement(Dn.a,{style:{padding:8}},r.a.createElement(an,{childrenStyle:{marginRight:5}},d,p,h),r.a.createElement("div",{style:{display:"flex"}},E)))}var ra=function(){const{configs:e}=Object(l.d)(Se),t=Object(l.d)(le),n=Object(l.d)(me),a=Object(l.c)();function c(){a(He()),a(We())}const o={onFilterSaved:function([e,n]){return!["not found","non-func"].includes(t.configs[e].form)},onFilterUnsaved:function([e,n]){return!["not found","non-func"].includes(t.configs[e].form)}};return r.a.createElement(nn,ta({label:"Configurations",panels:e,onGenerate:function([e,t]){return r.a.createElement(Kn,{key:e,panelId:e,panelType:"configs",onMouseOver:()=>a(xe(n,[e])),onMouseOut:()=>a(xe(n,[])),onSelect:c,onUnselect:c},r.a.createElement(na,{configId:e}))}},o))};var ca=function(){const{envs:e}=Object(l.d)(Se);return r.a.createElement(nn,{label:"Environments",panels:e,onGenerate:function([e,t]){return r.a.createElement(Kn,{key:e,panelId:e,panelType:"envs",onMouseOver:()=>{},onMouseOut:()=>{},disableSelect:!0,disableSelectMsg:"No action"},r.a.createElement(oa,{envId:e}))}})};function oa(e){const{envId:t}=e,n=Object(l.d)(le),{envs:a,instr:c,store:o,vals:s}=n,i=a[t].map(e=>{const t=c[e.instr].exprStrings.join(", "),n=o[e.addr].map(e=>{const{env:t,type:n,astString:a,valString:c}=s[e];let o;switch(n){case"closure":o=a;break;case"bool":o=c;break;default:o=`'${n}' value type unsupported`}const l=t?r.a.createElement(Yn,{envId:t}):void 0;return r.a.createElement(an,{key:e,childrenStyle:{marginRight:5}},r.a.createElement(ut.a,{display:"inline"},o),l)});return[e.varString,`[ ${t} ]`,n]});return r.a.createElement(en,{labels:["var","instr","store"],entries:i})}var la=class{constructor(e,t){this.cardIds=e,this.cardType=t,this.selected=void 0}select(e){this.selected=e}unselect(e){this.selected=void 0}get cards(){return this.cardIds}get type(){return this.cardType}},sa=n(223);function ia(){return(ia=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ua(e){const{frameId:t,selected:n,theme:a,classes:c,onSet:o,onUnset:s}=e,i=Object(l.d)(le),u=i.frames[t],{form:d,type:f,vals:m}=u;let p,h,E;switch(d){case"addr":{const{func:e,env:n,frames:a,cstacks:c}=u;p=r.a.createElement(da,null,r.a.createElement(Zn,{stackId:t,stackType:_}),r.a.createElement(fa,{label:"Form"},d),r.a.createElement(fa,{label:"Function"},i.funcs[e].form),r.a.createElement(Yn,{envId:n})),E=a?new la(a):new la(c,N);break}case"frame":{const{env:e,instr:t,exprString:n,next:a}=u,c=i.instr[t].exprStrings.join(", ");p=r.a.createElement(da,null,r.a.createElement(fa,{label:"Type"},f),r.a.createElement(Yn,{envId:e}),r.a.createElement(fa,{label:"Instrumentation"},`[ ${c} ]`)),h=r.a.createElement(ut.a,null,n),E=new la([a]);break}default:p=r.a.createElement(da,null,r.a.createElement(Zn,{stackId:t,stackType:_}),r.a.createElement(fa,{label:"Form"},d))}const y={};E&&(y.classes={root:c.enableHover},y.onClick=n?()=>s():()=>o(E));const g=h?r.a.createElement(ma,null,h):null;let v;return m&&(v=m.map((e,t)=>{const n=e.map(e=>r.a.createElement(ea,{key:e,valId:e}));return r.a.createElement("div",{key:t,style:{flex:"1 1 auto"}},n)})),r.a.createElement(Mn.a,ia({key:t},y,{style:{flex:"1 0 0",backgroundColor:n?a.palette.select.light:void 0,cursor:E?"pointer":void 0,minWidth:100}}),r.a.createElement(Dn.a,{style:{padding:8}},r.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap"}},p,r.a.createElement("div",null,r.a.createElement(Mt,{item:u}),g)),r.a.createElement("div",{style:{display:"flex"}},v)))}function da(e){const{children:t}=e,n=r.a.Children.map(t,e=>r.a.cloneElement(e,{style:{marginRight:"5px"}}));return r.a.createElement("div",null,n)}function fa(e){const{label:t,children:n,style:a}=e;return r.a.createElement(Ct.a,{title:t},r.a.createElement(ut.a,ia({display:"inline"},{style:a}),n))}function ma(e){const{children:t}=e;return r.a.createElement(Lt,{icon:r.a.createElement(sa.a,null),tooltip:"Show info"},t)}var pa=ua=Object(Ut.a)(e=>({enableHover:{"&:hover":{backgroundColor:`${e.palette.hover.light} !important`}}}),{withTheme:!0})(ua);var ha=function(e){const{children:t}=e;return r.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",margin:"5px 0"}},t)};function Ea(e){const{cstackId:t,selected:n,onSet:a,onUnset:c}=e,{cstacks:o}=Object(l.d)(le),s=o[t][0];return r.a.createElement(pa,{frameId:s,selected:n,onSet:e=>a(t,e),onUnset:()=>c(t)})}var ya=function(e){const{layer:t,onSet:n,onUnset:c}=e,o=t.cards.map(e=>r.a.createElement(Ea,{key:e,cstackId:e,selected:t.selected===e,onSet:n,onUnset:c}));return r.a.createElement(a.Fragment,null,r.a.createElement(ha,null,o),t.selected?r.a.createElement(ba,{cstackId:t.selected}):null)};var ga=function(e){const{layer:t,onSet:n,onUnset:a}=e,c=t.cards.map(e=>r.a.createElement(pa,{key:e,frameId:e,selected:t.selected===e,onSet:t=>n(e,t),onUnset:()=>a(e)}));return r.a.createElement(ha,null,c)};var va=function(e){const{frameId:t}=e,[n,c]=Object(a.useState)([new la([t])]);function o(e,t){const n=s(e);n[n.length-1].select(t),c(n)}function l(e,t){const n=s(e);n[n.length-1].unselect(t),c(n)}function s(e){return n.slice(0,e+1)}return n.map((e,t)=>{switch(e.type){case N:return r.a.createElement(ya,{key:t,layer:e,onSet:e=>o(t,e),onUnset:e=>l(t,e)});default:return r.a.createElement(ga,{key:t,layer:e,onSet:(e,a)=>(function(e,t,a){o(e,t),c([...n,a])})(t,e,a),onUnset:e=>l(t,e)})}})};var ba=function(e){const{cstackId:t}=e,{cstacks:n}=Object(l.d)(le),a=n[t].map(e=>r.a.createElement(va,{key:e,frameId:e}));return r.a.createElement("div",{style:{margin:5}},a)};var ja=function(){const{stacks:e}=Object(l.d)(Se);return r.a.createElement(nn,{label:"Stacks",panels:e,onGenerate:function([e,t]){const{[_]:n,[N]:a}=t;let c;return c=n?r.a.createElement(va,{frameId:n}):r.a.createElement(ba,{cstackId:a}),r.a.createElement(Kn,{key:e,panelId:e,panelType:D,onMouseOver:()=>{},onMouseOut:()=>{},disableSelect:!0,disableSelectMsg:"No action"},r.a.createElement("div",{style:{width:"100%"}},c))}})};function Oa(){const e=Object(l.d)(ue);let t=r.a.createElement(Wt,{status:"Downloading"});return e.items&&(t=r.a.createElement(on,{vertical:!0},r.a.createElement(Vt,{width:"40%"},r.a.createElement(Sn,null)),r.a.createElement(Vt,null,r.a.createElement(on,{horizontal:!0},r.a.createElement(Vt,{height:"48%"},r.a.createElement(on,{vertical:!0},r.a.createElement(Vt,{width:"48%",overflow:"auto"},r.a.createElement(An,null)),r.a.createElement(Vt,null,r.a.createElement(ja,null)))),r.a.createElement(Vt,{overflow:"auto"},r.a.createElement(on,null,r.a.createElement(Vt,{width:"50%",overflow:"auto"},r.a.createElement(ra,null)),r.a.createElement(Vt,{overflow:"auto"},r.a.createElement(ca,null)))))))),t}var ka=function(){const e=Object(l.d)(ae),t=Object(l.d)(se),n=Object(l.c)(),c=Object(a.useRef)(void 0);async function o(){await n(function(e){return async function(t){const n=Q.getState(),a=se(n,e),r=ue(n,e);let c=!1;switch(a){case T:r.code||t(rt(e));break;case $:await t(ot(e)),c=se(Q.getState(),e)===$;break;case P:r.items||(await t(ot(e)),t(Ve(e)));break;case R:r.error||await t(ot(e))}return c}}(e))&&(c.current=setTimeout(o,1e3))}let s;switch(Object(a.useEffect)(()=>(o(),()=>{clearTimeout(c.current)}),[]),Object(a.useEffect)(()=>{switch(t){case $:o()}},[t]),t){case x:case T:s=r.a.createElement(En,{edit:!0});break;case $:s=r.a.createElement(Wt,{status:"Processing"});break;case P:s=r.a.createElement(Oa,null);break;case R:s=r.a.createElement(En,{error:!0})}return s},wa=n(96),Sa=n.n(wa),Ia=n(97),Ca=n.n(Ia),xa=n(44),Ta=n.n(xa),$a=n(72),Pa=n.n($a),Ra=n(73),Aa=n.n(Ra);var Ma=Sa()({palette:{secondary:{light:Ta.a[300],main:Ta.a[500],dark:Ta.a[700]},select:{light:Ta.a[100],main:Ta.a[400]},hover:{light:Pa.a[100],main:Pa.a[400]},suggest:{main:Aa.a[400],dark:Aa.a[700]},warn:{main:Ca.a.A700,contrastText:"#fff"}}}),Da=n(235),_a=n(224),Na=n(225);var Ua=Object(l.b)(e=>{const t=we(e);return{projectId:t,name:t?oe(e,t).name:""}},{rename:function(e,t){return async function(n){const a=ee(Q.getState());return n(Qe(e,{name:t})),fetch(`/api/${a}/projects/${e}/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t})})}},setRenameDialog:Re})((function(e){const{projectId:t,name:n,rename:c,setRenameDialog:o}=e,[l,s]=Object(a.useState)(void 0);function i(){o(void 0)}return Object(a.useEffect)(()=>s(n||""),[n]),r.a.createElement(Da.a,{open:Boolean(t),onClose:i},r.a.createElement(_a.a,null,r.a.createElement(pt.a,{label:"name",value:l,onChange:e=>s(e.target.value),placeholder:`project ${t} name`})),r.a.createElement(Na.a,null,r.a.createElement(dt.a,{onClick:i},"cancel"),r.a.createElement(dt.a,{onClick:()=>{i(),c(t,l)}},"rename")))})),La=n(231),Fa=n(98),za=n.n(Fa);var Ba=function(){const e=Object(l.d)(ke),t=Object(l.c)(),[n,c]=Object(a.useState)(void 0);function o(){clearTimeout(n),t(Pe())}return Object(a.useEffect)(()=>{e&&c(setTimeout(()=>{o()},2e4))},[e]),r.a.createElement(La.a,{open:Boolean(e),onClose:function(e,t){"clickaway"!==t&&o()},action:[r.a.createElement(bt.a,{key:"close",onClick:o,color:"inherit"},r.a.createElement(za.a,null))],autoHideDuration:2e4,message:e,anchorOrigin:{horizontal:"left",vertical:"bottom"}})};var Ga=function(){const e=Object(l.d)(te),t=Object(l.d)(ne),n=Object(l.d)(ae),c=Object(l.c)();let o,s,i;switch(e){case S:o=r.a.createElement(ht,null);break;case I:s=r.a.createElement(Wa,null),i=r.a.createElement(a.Fragment,null,r.a.createElement(qa,null),r.a.createElement(Ka,{content:"new project",onClick:()=>c(nt())}),r.a.createElement(Va,null)),o=r.a.createElement(un,null);break;case C:s=r.a.createElement(Wa,null),i=r.a.createElement(a.Fragment,null,r.a.createElement(Ka,{content:"fork project",onClick:()=>c(at(n))}),r.a.createElement(Ka,{content:"export project",onClick:()=>c(lt(n))}),r.a.createElement(Va,null)),o=r.a.createElement(ka,null)}const u=r.a.createElement(st.a,{position:"static"},r.a.createElement(it.a,null,s,r.a.createElement(ut.a,{variant:"h6",color:"inherit",style:{flex:"1 1 auto",overflow:"hidden",textOverflow:"ellipsis",textAlign:"center"}},t),i));return r.a.createElement(ft.a,{theme:Ma},r.a.createElement(Ja,null),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"}},!1,u,o,r.a.createElement(Ba,null),r.a.createElement(Ua,null)))};function Ja(){return r.a.createElement("div",{style:{display:"flex",height:"100%",width:"100%",position:"fixed",justifyContent:"flex-end",alignItems:"flex-end",pointerEvents:"none",zIndex:-1}},r.a.createElement(ut.a,{variant:"caption",color:"textSecondary",style:{padding:5}},"0.3.11"))}function Ha(e){const{content:t,theme:n}=e;return r.a.createElement(ut.a,{style:{display:"flex",justifyContent:"center",backgroundColor:n.palette.warn.main,color:n.palette.warn.contrastText}},t)}function Wa(){const e=Object(l.c)();return r.a.createElement(Ka,{content:"project list",onClick:()=>e(Ze(void 0))})}function Va(){const e=Object(l.c)();return r.a.createElement(Ka,{content:"logout",onClick:t=>e(function(e){return e=>{e(Y(void 0)),e(Xe())}}())})}function qa(){const e=Object(a.useRef)(void 0),t=Object(l.c)();function n(n){const a=new FileReader;a.onload=()=>{const e=JSON.parse(a.result),r=n.name,c=r.match(/aam-vis-(.*)\.json/);if(c){const n=c[1];t(function(e,t){return n=>{t.status=P,n(Ke(e)),n(Qe(e,t)),n(Ve(e))}}(n,e))}else t($e(`'${r}' file name incorrectly formatted ('aam-vis-<projectId>.json')`))},a.readAsText(n),e.current.value=""}return r.a.createElement(a.Fragment,null,r.a.createElement(Ka,{content:"import",onClick:()=>e.current.click()}),r.a.createElement("input",{ref:e,onChange:()=>n(e.current.files[0]),type:"file",hidden:!0}))}function Ka(e){const{content:t,onClick:n}=e;return r.a.createElement(dt.a,{onClick:n,color:"inherit",variant:"outlined",style:{margin:Ma.spacing(1)}},t)}Ha=Object(mt.a)(Ha);n(144);o.a.render(r.a.createElement(l.a,{store:Q},r.a.createElement(Ga,null)),document.getElementById("app"))}});