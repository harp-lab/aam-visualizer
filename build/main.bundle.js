!function(e){function t(t){for(var a,c,s=t[0],l=t[1],i=t[2],d=0,p=[];d<s.length;d++)c=s[d],Object.prototype.hasOwnProperty.call(r,c)&&r[c]&&p.push(r[c][0]),r[c]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(u&&u(t);p.length;)p.shift()();return o.push.apply(o,i||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,s=1;s<n.length;s++){var l=n[s];0!==r[l]&&(a=!1)}a&&(o.splice(t--,1),e=c(c.s=n[0]))}return e}var a={},r={0:0},o=[];function c(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=a,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(n,a,function(t){return e[t]}.bind(null,a));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="";var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var i=0;i<s.length;i++)t(s[i]);var u=l;o.push([147,1]),n()}({143:function(e,t,n){var a=n(144);"string"==typeof a&&(a=[[e.i,a,""]]);var r={insert:"head",singleton:!1};n(146)(a,r);a.locals&&(e.exports=a.locals)},144:function(e,t,n){(t=e.exports=n(85)(!1)).i(n(145),""),t.push([e.i,"body{margin:0}#app{height:100vh}.CodeMirror{height:100%}.CodeMirror .mark{color:#3f51b5;cursor:pointer;font-size:0.6rem;line-height:inherit;padding-right:2px;vertical-align:top}.CodeMirror .mark:hover{color:#7986cb}.CodeMirror .selected{background-color:#fff59d}\n",""])},147:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(10),c=n.n(o),s=n(6),l=n(17);const i="SET_USER",u="SET_TITLE",d="ADD_PROJECT",p="SET_PROJECT_DATA",f="SET_METADATA",m="SET_GRAPH_METADATA",h="ADD_PANEL",E="SET_PANEL",g="REFRESH_PANELS",y="DEL_PROJECT",v="DEL_PROJECTS",b="SEL_PROJECT",j={userId:void 0};const k={snackbars:[],dialogs:{},loading:!1};function O(e,t){return(n,a)=>{const r=void 0===n;return t(a)||r?e(n,a):n}}function w(e={},t){switch(t.type){case h:{const{panelId:n,label:a}=t.payload;return{...e,[n]:{label:a,saved:!1,hidden:!0,selected:!1}}}case E:{const{panelId:n,data:a}=t.payload,r=e[n];return{...e,[n]:{...r,...a}}}case g:{const{func:n}=t.payload,a={};for(const[t,r]of Object.entries(e)){const e=n(t,r);a[t]={...r,...e}}return a}default:return e}}const S=Object(l.c)({configs:O(w,e=>!!e.payload&&"configs"===e.payload.type),envs:O(w,e=>!!e.payload&&"envs"===e.payload.type),konts:O(w,e=>!!e.payload&&"konts"===e.payload.type)});var C=Object(l.c)({data:function(e={},t){switch(t.type){case f:{const{data:n}=t.payload;return{...e,...n}}default:return e}},graphs:function(e={},t){switch(t.type){case m:{const{graphId:n,data:a}=t.payload,r=e[n];return{...e,[n]:{...r,...a}}}default:return e}},panels:S});const I={status:"empty",STATUSES:{empty:"empty",edit:"edit",process:"process",done:"done",error:"error"},code:""};var x=Object(l.c)({data:function(e=I,t){switch(t.type){case p:{const{data:n}=t.payload;return{...e,...n}}default:return e}},metadata:C});var T=Object(l.c)({data:function(e={selectedProjectId:void 0},t){switch(t.type){case b:{const{projectId:n}=t.payload;return{...e,selectedProjectId:n}}default:return e}},projects:function(e={},t){switch(t.type){case d:case p:default:if(t.payload&&t.payload.projectId){const{projectId:n}=t.payload,a=e[n];return{...e,[n]:x(a,t)}}return e;case y:{const{projectId:n}=t.payload,{[n]:a,...r}=e;return{...r}}case v:return{}}}}),P=Object(l.c)({data:function(e=j,t){switch(t.type){case i:{const{userId:n}=t.payload;return{...e,userId:n}}case u:{const{title:n}=t.payload;return{...e,title:n}}default:return e}},notifications:function(e=k,t){switch(t.type){case"QUEUE_SNACKBAR":{const{text:n}=t.payload,{snackbars:a}=e;return{...e,snackbars:[...a,n]}}case"DEQUEUE_SNACKBAR":{const{snackbars:t}=e;t.shift();return{...e,snackbars:[...t]}}case"SET_LOADING":{const{loading:n}=t.payload;return{...e,loading:n}}case"SET_DIALOG":{const{dialogId:n,data:a}=t.payload,{dialogs:r}=e;return{...e,dialogs:{...r,[n]:a}}}default:return e}},projects:T}),M=n(88);const $=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||l.d;var D=Object(l.e)(P,$(Object(l.a)(M.a)));const R=e=>({type:i,payload:{userId:e}});const A=e=>({type:u,payload:{title:e}}),N=e=>({type:d,payload:{projectId:e}}),_=(e,t)=>({type:p,payload:{projectId:e,data:t}}),U=e=>({type:y,payload:{projectId:e}}),L=()=>({type:v}),F=e=>({type:b,payload:{projectId:e}}),z=(e,t)=>({type:f,payload:{projectId:e,data:t}});function G(e){return e.projects}function B(e){return G(e).projects}function J(e){return G(e).data.selectedProjectId}function H(e,t){return t||(t=J(e)),B(e)[t]}function W(e,t){const{items:n}=H(e,t).data;return n}function V(e,t){return H(e,t).data}function K(e){return H(e).metadata}function q(e){return W(e).graphs}function Q(e){return K(e).data.mainGraphId||"funcs"}function Y(e){const t=te(e,Q(e));let n="states";if(t.length>0){const a=t[0],r=W(e),{form:o}=r.funcs[a];["halt","not found","non-func","unknown"].includes(o)||(n=a)}return n}function X(e){const t=Q(e);return K(e).data.focusedGraph||t}function Z(e,t){return q(e)[t]}function ee(e,t){return function(e){return K(e).graphs}(e)[t]||{}}function te(e,t){return ee(e,t).selectedNodes||[]}function ne(e,t){const n=W(e);switch(t){case"funcs":return n.funcs;case"states":default:return n.configs}}function ae(e){return[Q(e),Y(e)].flatMap(t=>{return re(function(e,t){return ee(e,t).hoveredNodes||[]}(e,t),ne(e,t))})}function re(e,t){const n=new Set;for(const a of e){const{astLink:e,expr:r}=t[a];let o=[];e?o=e:r&&(o=[r]),o.forEach(e=>n.add(e))}return[...n]}const oe="LOGIN_VIEW",ce="LIST_VIEW",se="PROJECT_VIEW",le="edit",ie="process";function ue(e){return e.data}function de(e){return ue(e).userId}function pe(e){const t=de(e),n=J(e);return t?n?se:ce:oe}function fe(e){return ue(e).title}function me(e){return e.notifications}function he(e){const{snackbars:t}=me(e);return t[0]}function Ee(e){return function(e,t){const{dialogs:n}=me(e);return n[t]}(e,"rename")}function ge(e){return K(e).panels}function ye(e,t,n,a){const r=D.getState();return e||(e=J(r)),{type:h,payload:{projectId:e,type:t,panelId:n,label:a}}}const ve=(e,t,n)=>ye(e,"configs",t,n),be=(e,t,n)=>ye(e,"envs",t,n),je=(e,t,n)=>ye(e,"konts",t,n);function ke(e,t,n){const a=J(D.getState());return{type:E,payload:{projectId:a,type:e,panelId:t,data:n}}}const Oe=(e,t)=>ke(e,t,{hidden:!0}),we=(e,t)=>ke(e,t,{hidden:!1}),Se=(e,t)=>ke(e,t,{saved:!0}),Ce=(e,t)=>ke(e,t,{saved:!1}),Ie=(e,t)=>ke(e,t,{selected:!0}),xe=(e,t)=>ke(e,t,{selected:!1}),Te=e=>we("konts",e),Pe=e=>we("envs",e);function Me(e,t){const n=J(D.getState());return{type:g,payload:{projectId:n,type:e,func:t}}}function $e(){return e=>{e(function(){const e=D.getState(),t=Y(e),n=te(e,t);return Me("configs",(e,t)=>n.includes(e)?{selected:!0,hidden:!1}:{hidden:!0})}()),e(De()),e(Re())}}function De(){const e=D.getState(),t=W(e),{configs:n,envs:a}=ge(e),r=[];for(const[e,a]of Object.entries(n))if(!a.hidden&&a.selected){const n=t.configs[e].states;if(n)for(const e of n){const n=t.states[e].env;n&&r.push(n)}}return Me("envs",(e,t)=>r.includes(e)?{hidden:!1}:{hidden:!0})}function Re(){const e=D.getState(),t=W(e),{configs:n,konts:a}=ge(e),r=[];for(const[e,a]of Object.entries(n))if(!a.hidden&&a.selected){const n=t.configs[e].states;if(n)for(const e of n){const n=t.states[e].kont;r.push(n)}}return Me("konts",(e,t)=>r.includes(e)?{hidden:!1}:{hidden:!0})}function Ae(e){return t=>{const n=W(D.getState(),e);n.configs&&t(function(e){return t=>{const n=W(D.getState(),e);for(const[a,r]of Object.entries(n.configs)){const{form:o,states:c}=r;let s;if(c){const e=c[0],t=n.states[e];switch(t.form){case"halt":s=`[ ${t.results.map(e=>{const{type:t,name:a,valString:r}=n.vals[e];let o;switch(t){case"closure":o=a;break;case"bool":o=r}return o}).join(", ")} ]`;break;default:s=t.exprString}}t(ve(e,a,`${a}: ${o} - ${s}`))}}}(e)),n.envs&&t(function(e){return t=>{const n=W(D.getState(),e);for(const[a,r]of Object.entries(n.envs)){const n=r.map(e=>e.varString).join(", ");t(be(e,a,`${a}: [ ${n} ]`))}}}(e)),n.konts&&t(function(e){return t=>{const n=W(D.getState(),e);for(const[a,r]of Object.entries(n.konts)){const{descs:r}=n.konts[a];let o;o=r.length>1?`[ ${r[0]}, ... +${r.length-1} ]`:`[ ${r[0]} ]`,t(je(e,a,o))}}}(e))}}function Ne(e,t){const n=J(D.getState());return{type:m,payload:{projectId:n,graphId:e,data:t}}}function _e(e,t){return n=>{const a=te(D.getState(),e),r=new Set([...a,...t]);n(Ne(e,{selectedNodes:[...r]})),n($e())}}function Ue(e,t){return Ne(e,{hoveredNodes:t})}function Le(e,t){return n=>{n(Ne(e,{selectedEdges:t}));const a=D.getState(),{graph:r}=Z(a,e),o=Q(a),c=new Set;for(const e of t){const[t,n]=e.split("-"),a=r[t][n],{calls:o}=a;if(o)for(const e of o)c.add(e)}n(function(e,t){return Ne(e,{suggestedNodes:t})}(o,[...c]))}}const Fe=e=>({type:"QUEUE_SNACKBAR",payload:{text:e}}),ze=()=>({type:"DEQUEUE_SNACKBAR"}),Ge=e=>({type:"SET_DIALOG",payload:{dialogId:"rename",data:e}});function Be(e,t){const n=de(D.getState());return fetch(`/api/${n}/${e}`,{method:t})}function Je(){return async function(e){const t=await Be("create","GET"),n=(await t.json()).id;return e(N(n)),e(F(void 0)),n}}function He(e){return async function(t){let n=D.getState(),a=V(n,e);a.status!==a.STATUSES.empty&&(await t(We(e)),a=V(n=D.getState(),e));const r=await t(Je()),{code:o,analysis:c}=a;t(_(r,{code:o,analysis:c})),t(F(r))}}function We(e){return async function(t){const n=await Be(`projects/${e}/code`,"GET"),{code:a}=await n.json();t(_(e,{code:a}))}}function Ve(e,t){return n=>{const a=D.getState(),{userId:r,status:o,STATUSES:c}=V(a,e);switch(o){case c.empty:case c.edit:{let a=c.edit;return""==t&&(a=c.empty),n(_(e,{status:a,code:t})),fetch(`/api/${r}/projects/${e}/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:t})})}}}}function Ke(e){return async function(t){const n=await Be(`projects/${e}/data`,"GET");switch(n.status){case 200:{const a=await n.json();return t(_(e,a)),n.status}case 204:return n.status;case 412:return t(Fe("Project data request rejected")),n.status}}}function qe(e){return async function(t){switch(await t(Ke(e))){case 200:{const t=V(D.getState(),e),n=JSON.stringify(t,null,2),a=new Blob([n],{type:"application/json"}),r=URL.createObjectURL(a),o=`aam-vis-${e}.json`,c=document.createElement("a");Object.assign(c,{href:r,download:o}),document.body.appendChild(c),c.click(),c.remove(),URL.revokeObjectURL(r);break}case 204:t(Fe("Project still processing"))}}}var Qe=n(228),Ye=n(206),Xe=n(199),Ze=n(46),et=n(229),tt=n(230);var nt=function(){const e=Object(s.c)(),[t,n]=Object(a.useState)("guest"),o=!/^\w+$/.test(t);return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%",justifyContent:"center",alignContent:"center",alignItems:"center"}},r.a.createElement(tt.a,{label:"username",value:t,onChange:e=>n(e.target.value),error:o,helperText:"You can use letters, numbers, & underscores"}),r.a.createElement(Xe.a,{onClick:()=>e(function(e){return t=>{t(R(e))}}(t)),disabled:o},"login"))},at=n(198),rt=n(149),ot=n(201),ct=n(202),st=n(150),lt=n(93),it=n.n(lt),ut=n(91),dt=n.n(ut),pt=n(92),ft=n.n(pt),mt=n(234),ht=n(98),Et=n(200),gt=n(90),yt=n.n(gt);var vt=function(e){const{items:t}=e,[n,o]=Object(a.useState)(void 0);function c(){o(void 0)}const s=t.map(e=>{const{label:t,callback:n}=e;return r.a.createElement(Et.a,{key:t,onClick:()=>{c(),n()}},t)});return r.a.createElement(a.Fragment,null,r.a.createElement(mt.a,{title:"More"},r.a.createElement(st.a,{color:"inherit",onClick:function(e){o(e.currentTarget)}},r.a.createElement(yt.a,null))),r.a.createElement(ht.a,{anchorEl:n,getContentAnchorEl:void 0,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},open:Boolean(n),onClose:c},s))};var bt=Object(s.b)(e=>{return{userId:de(e),projects:B(e)}},{getList:function(){return async function(e){const t=await Be("all","GET");switch(t.status){case 200:{const n=await t.json();let a=!1;for(const[t,r]of Object.entries(n)){const{status:n,name:o,analysis:c}=r;e(_(t,{status:n,name:o,analysis:c})),n===ie&&(a=!0)}return a}default:return!0}}},selProject:F,deleteProject:function(e){return async function(t){const n=J(D.getState());switch((await Be(`projects/${e}/delete`,"POST")).status){case 205:t(U(e)),n==e&&t(F(void 0));break;default:t(Fe(`Project ${e} delete request failed`))}}},cancelProcess:function(e){return async function(t){switch((await Be(`projects/${e}/cancel`,"POST")).status){case 200:t(_(e,{status:le}));break;case 409:t(Fe(`Project ${e} cancel request denied - already finished`));break;default:t(Fe(`Project ${e} cancel request failed`));break}}},exportData:qe,forkProject:He,setRenameDialog:Ge})(function(e){const t=Object(a.useRef)(void 0),{projects:n,getList:o,selProject:c,deleteProject:s,cancelProcess:l,exportData:i,forkProject:u,setRenameDialog:d}=e;Object(a.useEffect)(()=>(async function(){await o()&&(t.current=setTimeout(o,1e3))}(),()=>{clearTimeout(t.current)}),[]);const p=Object.entries(n).map(([e,t])=>{const n=r.a.createElement(ot.a,{style:{flex:"0 0 10em"}},t.data.analysis),a=r.a.createElement(ot.a,{style:{overflow:"hidden",textOverflow:"ellipsis"}},t.data.name||"unnamed"),o=r.a.createElement(ot.a,{style:{flex:"0 0 10em"}},e),p=r.a.createElement(ot.a,{style:{flex:"0 0 10em"}},t.data.status);let f;f=t.data.status==t.data.STATUSES.process?r.a.createElement(mt.a,{title:"Cancel processing"},r.a.createElement(st.a,{onClick:()=>l(e)},r.a.createElement(dt.a,null))):r.a.createElement(mt.a,{title:"Delete"},r.a.createElement(st.a,{onClick:()=>s(e)},r.a.createElement(ft.a,null)));const m=r.a.createElement(ct.a,null,r.a.createElement(vt,{items:[{label:"Rename",callback:()=>d(e)},{label:"Export",callback:()=>i(e)}]}),r.a.createElement(mt.a,{title:"Fork"},r.a.createElement(st.a,{onClick:()=>u(e)},r.a.createElement(it.a,null))),f);return r.a.createElement(rt.a,{button:!0,key:e,onClick:()=>{c(e)},align:"flex-start",style:{paddingRight:160}},n,a,o,p,m)});return r.a.createElement(at.a,{style:{overflowY:"auto"}},p)}),jt=n(204),kt=n(203),Ot=n(205);var wt=class extends a.Component{constructor(e){super(e)}render(){const e=this.props.height,t=this.props.width,n=this.props.overflow,a=r.a.Children.map(this.props.children,n=>{const a={...t?{width:t}:{},...e?{height:e}:{}};return r.a.cloneElement(n,a)}),o={display:"flex",flexDirection:"column",height:e||"100%",width:t||"100%",overflow:n||"hidden",...this.props.style};return r.a.createElement("div",{style:o},a)}};var St=class extends a.Component{render(){let e;switch(this.props.variant){case"linear":e=r.a.createElement(wt,null,r.a.createElement(kt.a,null),r.a.createElement(Ze.a,{variant:"h6",style:{flex:"1 1 auto",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},this.props.status));break;case"circular":e=r.a.createElement(wt,{style:{justifyContent:"center",alignItems:"center"}},r.a.createElement(jt.a,{in:!0,style:{transitionDelay:"1000ms"}},r.a.createElement(Ot.a,null)),r.a.createElement(jt.a,{in:!0,style:{transitionDelay:"200ms"}},r.a.createElement(Ze.a,{variant:"h6",style:{marginTop:"2em"}},this.props.status)))}return e}};function Ct(e){let t={backgroundColor:"darkgray"};return t=e.horizontal?{...t,height:5,cursor:"ns-resize"}:{...t,width:5,cursor:"ew-resize"},r.a.createElement("div",{style:t,onMouseDown:e.onMouseDown})}var It=function(e){const t=Object(a.useRef)(void 0),[n,o]=Object(a.useState)(!1),c=e.children[0].props,s=parseInt(c.width||c.height),[l,i]=Object(a.useState)(s);function u(){o(!0)}function d(){n&&o(!1)}const p=100-l;let f,m,h,E;return e.horizontal?(f=r.a.cloneElement(e.children[0],{height:`${l}%`}),m=r.a.cloneElement(e.children[1],{height:`${p}%`}),h=r.a.createElement(Ct,{horizontal:!0,onMouseDown:u}),E="ns-resize"):(f=r.a.cloneElement(e.children[0],{width:`${l}%`}),m=r.a.cloneElement(e.children[1],{width:`${p}%`}),h=r.a.createElement(Ct,{vertical:!0,onMouseDown:u}),E="ew-resize"),r.a.createElement("div",{ref:t,style:{display:"flex",flexDirection:e.horizontal?"column":"row",flex:"1 1 auto",minHeight:0,cursor:n?E:"default"},onMouseMove:function(a){if(n){let n;!function(){const e=window.getSelection();e&&e.removeAllRanges()}();const r=t.current.getBoundingClientRect();n=e.horizontal?(a.clientY-r.y)/r.height*100:(a.clientX-r.x)/r.width*100,i(n)}},onMouseUp:d,onMouseLeave:d},f,h,m)},xt=n(236),Tt=n(231),Pt=n(71),Mt=n.n(Pt);n(121);var $t=Object(s.b)(e=>{const t=J(e),{code:n}=V(e);return{projectId:t,code:n}},{saveCode:Ve,processCode:function(e,t,n){return async function(a){a(Ve(e,t));const r=D.getState(),{userId:o}=V(r,e);switch((await fetch(`/api/${o}/projects/${e}/process`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).status){case 200:a(_(e,{status:"process"}));break;case 412:a(Fe("Project process request rejected"))}}}})(class extends a.Component{constructor(e){let t;if(super(e),this.props.processOptions){t={analysis:this.props.processOptions.analysis[0]}}this.state={processOptions:t},this.process=this.process.bind(this)}set value(e){this.cm.getDoc().setValue(e)}get value(){return this.cm.getDoc().getValue()}save(){this.props.saveCode(this.props.projectId,this.value)}process(){this.props.processCode(this.props.projectId,this.value,this.state.processOptions)}refresh(){this.value=this.props.code,this.props.marks&&(this.clearMarks(),this.renderMarks())}renderMarks(){const e=this.cm.getDoc();for(const[t,n]of Object.entries(this.props.marks)){const a=document.createElement("div");a.style.cssText="display: inline;",a.addEventListener("click",e=>{this.props.onNodeSelect(n.graphId,t)});const o=r.a.createElement(Ze.a,{variant:"caption",display:"inline",classes:{root:"mark"}},t);c.a.render(o,a),e.setBookmark(n.end,{widget:a,insertLeft:!0})}}selectMark(){const e=this.props.selected,t=this.cm.getDoc();let n;if(this.selectedMark&&(this.selectedMark.clear(),(n=t.getAllMarks()).forEach(e=>{"bookmark"==e.type&&e.widgetNode.classList.remove("selected")})),e){const a=this.props.marks[e];a&&(t.setCursor(a.start),this.selectedMark=t.markText(a.start,a.end,{className:"selected"}),(n=t.findMarks(a.start,a.end)).forEach(e=>{"bookmark"==e.type&&e.widgetNode.classList.add("selected")}))}}clearMarks(){this.cm.getDoc().getAllMarks().forEach(e=>e.clear())}componentDidMount(){const e={lineWrapping:!0,lineNumbers:!0,readOnly:!this.props.edit};this.cm=Mt()(this.cmRef,e),this.refresh(),this.selectMark()}componentDidUpdate(e){const t=this.props.code!==e.data,n=this.props.id!==e.id,a=this.props.type!==e.type;(t||n||a)&&this.refresh(),this.props.selected!==e.selected&&this.selectMark()}componentWillUnmount(){this.props.edit&&this.save()}render(){let e,t;if(this.props.edit){e=r.a.createElement(Ze.a,null,"Input code for analysis");const n=this.props.processOptions.analysis.map(e=>r.a.createElement(Et.a,{key:e,value:e},e));t=r.a.createElement(Ye.a,null,r.a.createElement("div",{style:{flex:"1 1 auto"}},r.a.createElement(xt.a,null,"Analysis"),r.a.createElement(Tt.a,{value:this.state.processOptions.analysis,onChange:e=>{const t=e.target.value;this.setState(e=>{const n=e.processOptions;return n.analysis=t,{processOptions:n}})}},n)),r.a.createElement(Dt,{onClick:this.process}))}return this.props.error&&(e=r.a.createElement(r.a.Fragment,null,r.a.createElement(Ze.a,{variant:"h3"},"Analysis error"),r.a.createElement(Ze.a,null,this.props.errorContent))),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"auto"}},e,r.a.createElement("div",{ref:e=>this.cmRef=e,style:{flex:"1 1 auto",overflow:"auto",height:"100%"}}),t)}});class Dt extends a.Component{render(){return r.a.createElement(Xe.a,{onClick:e=>{this.props.onClick()},variant:"contained",color:"secondary"},"process")}}var Rt=n(207),At=n(94),Nt=n.n(At);var _t=function(e,t){return{group:"nodes",data:{id:e,label:`${e}\n${t}`,form:t}}};var Ut=function(e,t,n,a){const{label:r="",style:o}=a;return{group:"edges",data:{id:e,label:r,source:t,target:n,style:o}}};var Lt=function(e,t){const n=t.graphs[e],{graph:a,start:r}=n;function o(e,t){const n=[];for(const[a,r]of Object.entries(e)){const{form:e}=t[a];n.push(_t(a,e));for(const[e,o]of Object.entries(r)){const{form:r}=t[e];n.push(_t(e,r));const c=`${a}-${e}`;n.push(Ut(c,a,e,o))}}return n}switch(e){case"funcs":return o(a,t.funcs);case"states":default:return o(a,t.configs)}};function Ft(e){const t=Object(a.useRef)(void 0),n=Object(a.useRef)(void 0),o=Object(a.useRef)(!1),{graphId:c,edgePredicate:l,onNodeSelect:i,onNodeUnselect:u,theme:d}=e,p=Object(s.d)(W),f=Lt(c,p),m=Object(s.d)(e=>ee(e,c)),h=Object(s.d)(X)===c,E=Object(s.c)(),g={style:[{selector:"node",style:{label:"data(label)","text-wrap":"wrap"}},{selector:"node:selected",style:{"background-color":d.palette.select.main}},{selector:"edge",style:{label:"data(label)","curve-style":"bezier","target-arrow-shape":"triangle","line-style":(y="line-style",v="solid",e=>{const t=e.data("style");let n;return n=t&&t[y]?t[y]:v})}},{selector:"edge:selected",style:{"line-color":d.palette.select.main,"target-arrow-color":d.palette.select.main}},{selector:".suggested",style:{"background-color":d.palette.suggest.main}},{selector:e=>e.hasClass("suggested")&&e.selected(),style:{"background-color":d.palette.suggest.dark}},{selector:".hovered",style:{"background-color":d.palette.hover.main}}],headless:!0};var y,v;const b=Object(a.useRef)(Nt()(g)).current,{positions:j,selectedNodes:k=[],selectedEdges:O=[],hoveredNodes:w=[],suggestedNodes:S=[]}=m;function C(e){const t=b.$("node:selected");switch(e.key){case"ArrowLeft":const n=t.incomers().nodes();1==n.length&&(t.unselect(),n.select());break;case"ArrowRight":const a=t.outgoers().nodes();1==a.length&&(t.unselect(),a.select())}}function I(e,t){T(b.nodes(),e,e=>e.id(),e=>e.addClass(t))}function x(e,t){T(b.nodes(),e,e=>e.id(),e=>e.removeClass(t))}function T(e,t,n,a){let r=[...t],o=0;for(;o<e.length&&r.length>0;){const t=e[o],c=n(t),s=r.findIndex(e=>e==c);-1!==s&&(r.splice(s,1),a(t)),o++}}return Object(a.useEffect)(()=>(b.mount(t.current),()=>b.unmount()),[]),Object(a.useEffect)(()=>{if(h)return document.addEventListener("keydown",C),()=>{document.removeEventListener("keydown",C)}},[h]),Object(a.useEffect)(()=>(["tap","select","unselect","mouseover","mouseout"].forEach(e=>b.off(e)),b.on("tap",()=>E(function(e){const t=J(D.getState());return z(t,{focusedGraph:e})}(c))),b.on("select","node",e=>{if(o.current){const t=e.target.id();E(_e(c,[t])),i&&i(t)}}),b.on("unselect","node",e=>{if(o.current){const t=e.target.id();E(function(e,t){return n=>{const a=te(D.getState(),e),r=new Set(a);t.forEach(e=>r.delete(e)),n(Ne(e,{selectedNodes:[...r]})),n($e())}}(c,[t])),u&&u(t)}}),b.on("mouseover","node",e=>{const t=e.target.id();w!=[t]&&E(Ue(c,[t]))}),b.on("mouseout","node",e=>{E(Ue(c,[]))}),b.on("select","edge",e=>{if(o.current){const t=e.target;if(l(t)){const e=t.id();E(Le(c,[e]))}else t.unselect()}}),b.on("unselect","edge",e=>{o.current&&E(Le(c,[]))}),b.add(f),j?(b.nodes().positions(e=>j[e.data("id")]),b.fit()):b.layout({name:"cose",directed:!0}).run(),()=>{const e={};for(const t of f){const n=t.data.id;e[n]=b.$id(n).position()}E(function(e,t){return Ne(e,{positions:t})}(c,e)),b.nodes().remove()}),[c]),Object(a.useEffect)(()=>{return o.current=!1,function(e){e.forEach(e=>b.$id(e).select())}([...k,...O]),o.current=!0,()=>{o.current=!1,function(e){e.forEach(e=>b.$id(e).unselect())}([...k,O]),o.current=!0}},[k,O]),Object(a.useEffect)(()=>(o.current=!1,I(S,"suggested"),o.current=!0,()=>{o.current=!1,x(S,"suggested"),o.current=!0}),[S]),Object(a.useEffect)(()=>(o.current=!1,I(w,"hovered"),o.current=!0,()=>{o.current=!1,x(w,"hovered"),o.current=!0}),[w]),Object(a.useEffect)(()=>{b.resize()},[n.current]),Object(a.useEffect)(()=>{n.current=t.current.getBoundingClientRect()}),r.a.createElement("div",{style:{flex:"1 1 1%",display:"block",minHeight:0,width:"100%"},ref:t})}var zt=Ft=Object(Rt.a)(Ft);function Gt(e){const{content:t,theme:n}=e;return r.a.createElement(Ye.a,{variant:"dense",style:{backgroundColor:n.palette.grey[300],color:n.palette.text.primary,width:"100%",minHeight:"unset"}},r.a.createElement(Ze.a,null,t))}Gt=Object(Rt.a)(Gt);var Bt=function(){const e=Object(s.d)(Q),t=Object(s.d)(Y);return r.a.createElement(It,{horizontal:!0},r.a.createElement(wt,{height:"50%"},r.a.createElement(Gt,{content:e}),r.a.createElement(zt,{graphId:e,edgePredicate:e=>!1})),r.a.createElement(wt,{height:"50%"},r.a.createElement(Gt,{content:t}),r.a.createElement(zt,{graphId:t,edgePredicate:e=>{const t=e.data("style");return!!t&&"dashed"===t["line-style"]}})))};var Jt=class{constructor(e,t){this.line=e,this.ch=t}toString(){return`line ${this.line} ch ${this.ch}`}},Ht=n(72),Wt=n.n(Ht);var Vt=class{constructor(e,t){this.start=e,this.end=t,this.nodes={}}addNode(e,t){this.nodes[e]?this.nodes[e].push(t):this.nodes[e]=[t]}in(e,t,n){let a=!1;if(t.line==n.line){const r=t.line<=e.line&&e.line<=n.line,o=t.ch<=e.ch&&e.ch<n.ch;r&&o&&(a=!0)}else{const r=e.line==t.line,o=e.line==n.line,c=t.line<e.line&&e.line<n.line,s=t.ch<=e.ch,l=e.ch<n.ch;(r&&s||c||o&&l)&&(a=!0)}return a}startsIn(e,t){return this.in(this.start,e,t)}endsIn(e,t){return this.in(new Jt(this.end.line,this.end.ch-1),e,t)}includes(e,t){const n=this.in(e,this.start,this.end),a=this.in(new Jt(t.line,t.ch-1),this.start,this.end);return n&&a}has(e){return this.in(e,this.start,this.end)}smallerThan(e){const t=this.end.line-this.start.line<e.end.line-e.start.line,n=this.end.ch-this.start.ch<e.end.ch-e.start.ch;return t||!t&&n}coverage(e,t){let n,a;const r=this.includes(e,t);let o;return this.startsIn(e,t)?n=this.start:r&&(n=e),this.endsIn(e,t)?a=this.end:r&&(a=t),o=n&&a?a.ch-n.ch:0}};function Kt(e){const[t,n]=Object(a.useState)("auto"),{hovered:o,selected:c,hoverNodes:s,selectNodes:l,theme:i}=e,u=Object.entries(e.marks).reduce((e,t)=>{const[n,a]=t;return Object.keys(a.nodes).length>0&&(e[n]=a),e},{});function d(){for(const t of e.graphIds)s(t,void 0)}const p=e.code.split(/\r\n|\n/).map(e=>e.match(/\(|\)|\[|\]|\#t|\#f|\w+|\s+/g)),f=p.map((e,a)=>{let f=0;e||(e=[" "]);const m=e.map((e,t)=>{const n=new Jt(a,f),p=new Jt(a,f+e.length);f+=e.length;let m="inherit";e.match(/lambda|let|if|\#t|\#f/)&&(m=Wt.a[800]);const h=o.map(e=>u[e]),E=c.map(e=>u[e]),g=h.find(e=>e.includes(n,p)),y=E.find(e=>e.includes(n,p));let v=e;g?v=r.a.createElement(Qt,{content:e,color:i.palette.hover.light}):y&&(v=r.a.createElement(Qt,{content:e,color:i.palette.select.light}));const b=function(e,t){const n=new Jt(e,t);let a;return Object.entries(u).forEach(([e,t])=>{if(t.has(n))if(a){const n=u[a];t.smallerThan(n)&&(a=e)}else a=e}),a}(a,n.ch);return r.a.createElement(Yt,{key:t,content:v,textColor:m,onMouseOver:()=>(function(e){if(d(),e)for(const[t,n]of Object.entries(u[e].nodes))s(t,n)})(b),onClick:()=>(function(e){const t=u[e],n=t.nodes,a=Object.keys(t.nodes).filter(e=>"funcs"!==e);if(a.length>0){const e=a[0],t=n[e];l(e,t)}})(b),style:{cursor:"pointer"}})}),h=r.a.createElement("div",{style:{display:"inline-block",width:t,fontFamily:'Roboto Mono, "Courier New", Courier, monospace',backgroundColor:i.palette.grey[200],textAlign:"right",padding:"0 5px"}},r.a.createElement(Ze.a,{variant:"body2",ref:e=>{const r=a==p.length-1;if(e&&r){const a=e.getBoundingClientRect(),r=a.width;t!==r&&n(a.width)}},color:"textSecondary"},a+1));return r.a.createElement("div",{key:a},h,r.a.createElement(Ze.a,{onMouseLeave:()=>d(),variant:"body2",style:{display:"inline-block",verticalAlign:"bottom",fontFamily:'Roboto Mono, "Courier New", Courier, monospace'}},m))});return r.a.createElement("div",{style:{whiteSpace:"pre"}},f)}Kt=Object(Rt.a)(Kt);var qt=Object(s.b)(e=>{const{code:t}=V(e),n=[Q(e),Y(e)],a=W(e),r={};for(const[e,t]of Object.entries(a.ast)){const{start:n,end:a}=t,o=new Jt(n[0],n[1]),c=new Jt(a[0],a[1]);r[e]=new Vt(o,c)}function o(t){const n=function(e,t){const{graph:n}=Z(e,t),a=[];for(const[e,t]of Object.entries(n))a.push(e),a.concat(Object.keys(t));return a}(e,t),a=ne(e,t);for(const e of n){const n=re([e],a);for(const a of n)r[a].addNode(t,e)}}n.forEach(e=>o(e));const c=function(e){return[Q(e),Y(e)].flatMap(t=>{return re(te(e,t),ne(e,t))})}(e),s=ae(e);return{code:t,graphIds:n,marks:r,selected:c,hovered:s}},{hoverNodes:Ue,selectNodes:_e})(Kt);function Qt(e){const{content:t,color:n}=e;return r.a.createElement(Yt,{content:t,color:n})}function Yt(e){return r.a.createElement("span",{onMouseOver:e.onMouseOver,onClick:e.onClick,style:{display:"inline-block",backgroundColor:e.color||"inherit",color:e.textColor||"inherit",...e.style}},e.content)}var Xt=n(223),Zt=n(224),en=n(233),tn=n(214),nn=n(216),an=n(208),rn=n(209),on=n(210),cn=n(211),sn=n(212),ln=n(213),un=n(215),dn=n(151);function pn(){return(pn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function fn(e){const{panelId:t,panelType:n,panelData:o,children:c,theme:s,classes:l,selectPanel:i,unselectPanel:u,savePanel:d,unsavePanel:p,hidePanel:f}=e,[m,h]=Object(a.useState)(!1);const{selected:E,saved:g}=o;let y,v;v=e.disableSelect?r.a.createElement(hn,{icon:r.a.createElement(an.a,{color:"disabled"}),tooltip:e.disableSelectMsg,disabled:!0}):E?r.a.createElement(hn,{icon:r.a.createElement(on.a,null),tooltip:"Unselect",onClick:function(){u(n,t),e.onUnselect&&e.onUnselect()}}):r.a.createElement(hn,{icon:r.a.createElement(rn.a,null),tooltip:"Select",onClick:function(){i(n,t),e.onSelect&&e.onSelect()}}),y=g?r.a.createElement(hn,{icon:r.a.createElement(sn.a,null),tooltip:"Unsave",onClick:()=>p(n,t)}):r.a.createElement(hn,{icon:r.a.createElement(cn.a,null),tooltip:"Save",onClick:()=>d(n,t)});const b=r.a.createElement(hn,{icon:r.a.createElement(ln.a,null),tooltip:"Delete",onClick:()=>f(n,t)});return r.a.createElement(en.a,{onMouseOver:()=>{h(!0),e.onMouseOver()},onMouseOut:()=>{h(!1),e.onMouseOut()},defaultExpanded:!o.saved},r.a.createElement(tn.a,{expandIcon:r.a.createElement(un.a,null),classes:{root:l.panelRoot,content:l.panelContent,expandIcon:l.panelExpandIcon,expanded:l.panelExpanded},style:{backgroundColor:m?s.palette.hover.light:void 0}},v,y,b,r.a.createElement(Ze.a,null,o.label)),r.a.createElement(nn.a,null,c))}fn=Object(dn.a)(e=>({panelRoot:{minHeight:0,"&$panelExpanded":{minHeight:0}},panelContent:{alignItems:"center",margin:"5px 0","&$panelExpanded":{margin:"8px 0"}},panelExpandIcon:{padding:"5px 12px"},panelExpanded:{}}),{withTheme:!0})(fn);var mn=Object(s.b)((e,t)=>{const{panelId:n,panelType:a}=t;return{panelData:ge(e)[a][n]}},{selectPanel:Ie,unselectPanel:xe,savePanel:Se,unsavePanel:Ce,hidePanel:Oe})(fn);function hn(e){const{icon:t,tooltip:n,disabled:a,onClick:o}=e,c={};return a?(c.disableRipple=!0,c.onClick=e=>{e.stopPropagation()}):c.onClick=e=>{e.stopPropagation(),o()},r.a.createElement(mt.a,{title:n},r.a.createElement(st.a,pn({size:"small"},c),t))}var En=n(217);function gn(){return(gn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var yn=function(e){const{content:t,tooltip:n,onClick:a,style:o}=e;return r.a.createElement(mt.a,{title:n},r.a.createElement(En.a,gn({onClick:e=>{e.stopPropagation(),a()}},{style:o}),r.a.createElement(Ze.a,{display:"inline",style:{cursor:"pointer"}},t)))},vn=n(220),bn=n(221),jn=n(222),kn=n(219),On=n(218);var wn=function(e){const t=e.labels.map(e=>r.a.createElement(On.a,{key:e},e)),n=e.entries.map((e,t)=>{const n=e.map((e,t)=>r.a.createElement(On.a,{key:t},e));return r.a.createElement(kn.a,{key:t},n)});return r.a.createElement(vn.a,{size:"small"},r.a.createElement(bn.a,null,r.a.createElement(kn.a,null,t)),r.a.createElement(jn.a,null,n))};function Sn(e){const t=e.theme;return r.a.createElement(Ye.a,{variant:"dense",style:{backgroundColor:t.palette.secondary.main,color:t.palette.secondary.contrastText,minHeight:"auto"}},r.a.createElement(Ze.a,null,e.content))}Sn=Object(Rt.a)(Sn);var Cn=function(e){const{label:t,panels:n}=e,o=[...Object.entries(n).filter(([t,n])=>{const{saved:a}=n,r=a;let o=!0;return e.onFilterSaved&&(o=e.onFilterSaved([t,n])),r&&o}).map(e.onGenerate),...Object.entries(n).filter(([t,n])=>{const{saved:a,hidden:r}=n,o=!a&&!r;let c=!0;return e.onFilterUnsaved&&(c=e.onFilterUnsaved([t,n])),o&&c}).map(e.onGenerate)];return r.a.createElement(a.Fragment,null,r.a.createElement(Sn,{content:t}),r.a.createElement("div",{style:{overflowY:"auto"}},o))};function In(){return(In=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var xn=function(e){const{envId:t,style:n}=e,a=Object(s.c)();return r.a.createElement(yn,In({content:`env-${t}`,tooltip:"Show environment",onClick:()=>a(Pe(t))},{style:n}))};function Tn(){return(Tn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var Pn=function(e){const{kontId:t,style:n}=e,a=Object(s.c)();return r.a.createElement(yn,Tn({content:`stack-${t}`,tooltip:"Show stack",onClick:()=>a(Te(t))},{style:n}))};var Mn=Object(s.b)(e=>{return{items:W(e)}})(function(e){const{valId:t,items:n}=e,{type:a,astString:o,valString:c}=n.vals[t];let s;switch(a){case"bool":s=c;break;case"closure":s=o;break;default:s=`'${a}' value type unsupported`}return r.a.createElement(Ze.a,null,s)});function $n(){return($n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var Dn=Object(s.b)(e=>{const{configs:t}=ge(e);return{items:W(e),configs:t,subGraphId:Y(e)}},{hoverNodes:Ue,refreshEnvs:De,refreshKonts:Re})(function(e){const{configs:t,items:n,hoverNodes:a,subGraphId:o,refreshEnvs:c,refreshKonts:s}=e;function l(){c(),s()}const i={onFilterSaved:function([e,t]){return!["not found","non-func"].includes(n.configs[e].form)},onFilterUnsaved:function([e,t]){return!["not found","non-func"].includes(n.configs[e].form)}};return r.a.createElement(Cn,$n({label:"Configurations",panels:t,onGenerate:function([e,t]){const{label:n}=t;return r.a.createElement(mn,{key:e,panelId:e,panelType:"configs",onMouseOver:()=>a(o,[e]),onMouseOut:()=>a(o,[]),onSelect:l,onUnselect:l},r.a.createElement(Rn,{configId:e}))}},i))});function Rn(e){const{configId:t,items:n}=e,{states:a}=n.configs[t];let o;return a&&(o=a.map(e=>{const{form:t}=n.states[e];switch(t){case"halt":return;default:return r.a.createElement(An,{key:e,stateId:e})}})),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%"}},o)}function An(e){const{stateId:t,items:n}=e,{instr:a,kont:o,env:c,vals:s}=n.states[t],l=n.instr[a].exprStrings.join(", "),i=r.a.createElement(Ze.a,{display:"inline"},`[ ${l} ]`),u=r.a.createElement(Pn,{kontId:o}),d=c?r.a.createElement(xn,{envId:c}):void 0;let p;return s&&(p=s.map((e,t)=>{const n=e.map(e=>r.a.createElement(Mn,{key:e,valId:e}));return r.a.createElement("div",{key:t,style:{flex:"1 1 auto"}},n)})),r.a.createElement(Xt.a,{style:{width:"100%"}},r.a.createElement(Zt.a,{style:{padding:8}},r.a.createElement(Nn,null,i,u,d),r.a.createElement("div",{style:{display:"flex"}},p)))}function Nn(e){const{children:t}=e,n=r.a.Children.map(t,e=>{if(e)return r.a.cloneElement(e,{style:{marginRight:"5px"}})});return r.a.createElement("div",null,n)}Rn=Object(s.b)(e=>{return{items:W(e)}})(Rn),An=Object(s.b)(e=>{return{items:W(e)}})(An);var _n=function(e){const{envs:t}=Object(s.d)(ge);return r.a.createElement(Cn,{label:"Environments",panels:t,onGenerate:function([e,t]){return r.a.createElement(mn,{key:e,panelId:e,panelType:"envs",onMouseOver:()=>{},onMouseOut:()=>{},disableSelect:!0,disableSelectMsg:"No action"},r.a.createElement(Un,{envId:e}))}})};function Un(e){const{envId:t}=e,n=Object(s.d)(W),a=Object(s.c)(),{envs:o,instr:c,store:l,vals:i}=n,u=o[t].map(e=>{const t=c[e.instr].exprStrings.join(", "),n=l[e.addr].map(e=>{const{env:t,type:n,astString:o,valString:c}=i[e];let s,l;switch(n){case"closure":s=o;break;case"bool":s=c;break;default:s=`'${n}' value type unsupported`}return t&&(l=r.a.createElement(mt.a,{title:"View environment"},r.a.createElement(En.a,{onClick:()=>a(Pe(t))},r.a.createElement("sup",null,t)))),r.a.createElement(Ze.a,{key:e},s,l)});return[e.varString,`[ ${t} ]`,n]});return r.a.createElement(wn,{labels:["var","instr","store"],entries:u})}var Ln=n(196),Fn=n(225);var zn=class{constructor(e){this.cardIds=e,this.selected=void 0}select(e){this.selected=e}unselect(e){this.selected=void 0}get cards(){return this.cardIds}};function Gn(){return(Gn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var Bn=Object(s.b)(e=>{const{konts:t}=ge(e);return{konts:t}})(function(e){const{konts:t}=e;return r.a.createElement(Cn,{label:"Stacks",panels:t,onGenerate:function([e,t]){return r.a.createElement(mn,{key:e,panelId:e,panelType:"konts",onMouseOver:()=>{},onMouseOut:()=>{},disableSelect:!0,disableSelectMsg:"No action"},r.a.createElement(Jn,{kontId:e}))}})});function Jn(e){const{kontId:t}=e,[n,o]=Object(a.useState)([new zn([t])]);function c(e){return n.slice(0,e+1)}const s=n.map((e,t)=>r.a.createElement(Hn,{key:t,layer:e,onSet:(e,n)=>(function(e,t,n){const a=c(e);a[a.length-1].select(t),o([...a,n])})(t,e,n),onUnset:e=>(function(e,t){const n=c(e);n[n.length-1].unselect(t),o(n)})(t,e)}));return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%"}},s)}function Hn(e){const{layer:t}=e,n=t.cards.map(n=>r.a.createElement(Wn,{key:n,kontId:n,selected:t.selected==n,onSet:e.onSet,onUnset:e.onUnset}));return r.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",margin:"5px 0"}},n)}function Wn(e){const{kontId:t,selected:n,items:a,theme:o,classes:c}=e,s=a.konts[t],{form:l,type:i,vals:u}=s;let d,p,f;switch(l){case"addr":{const{func:e,env:n,konts:o}=s;d=r.a.createElement(Vn,null,r.a.createElement(Pn,{kontId:t}),r.a.createElement(Kn,{label:"Form"},l),r.a.createElement(Kn,{label:"Function"},a.funcs[e].form),r.a.createElement(xn,{envId:n})),f=new zn(o);break}case"frame":{const{env:e,instr:t,exprString:n,kont:o}=s,c=a.instr[t].exprStrings.join(", ");d=r.a.createElement(Vn,null,r.a.createElement(Kn,{label:"Type"},i),r.a.createElement(xn,{envId:e}),r.a.createElement(Kn,{label:"Instrumentation"},`[ ${c} ]`)),p=r.a.createElement(Ze.a,null,n),f=new zn([o]);break}default:d=r.a.createElement(Vn,null,r.a.createElement(Pn,{kontId:t}),r.a.createElement(Kn,{label:"Form"},l))}const m={style:{flex:"1 0 0",backgroundColor:n?o.palette.select.light:void 0,cursor:f?"pointer":void 0,minWidth:100}};let h,E;return f&&(m.classes={root:c.enableHover},m.onClick=n?()=>e.onUnset(t):()=>e.onSet(t,f)),p&&(h=r.a.createElement(qn,null,p)),u&&(E=u.map((e,t)=>{const n=e.map(e=>r.a.createElement(Mn,{key:e,valId:e}));return r.a.createElement("div",{key:t,style:{flex:"1 1 auto"}},n)})),r.a.createElement(Xt.a,Gn({key:t},m),r.a.createElement(Zt.a,{style:{padding:8}},r.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap"}},d,h),r.a.createElement("div",{style:{display:"flex"}},E)))}function Vn(e){const{children:t}=e,n=r.a.Children.map(t,e=>r.a.cloneElement(e,{style:{marginRight:"5px"}}));return r.a.createElement("div",null,n)}function Kn(e){const{label:t,children:n,style:a}=e;return r.a.createElement(mt.a,{title:t},r.a.createElement(Ze.a,Gn({display:"inline"},{style:a}),n))}function qn(e){const{children:t,classes:n}=e,[o,c]=Object(a.useState)(void 0);return r.a.createElement(a.Fragment,null,r.a.createElement(mt.a,{title:"Show info"},r.a.createElement(st.a,{size:"small",onClick:function(e){e.stopPropagation(),c(e.currentTarget)}},r.a.createElement(Fn.a,null))),r.a.createElement(Ln.a,{open:Boolean(o),anchorEl:o,onClose:function(e){e.stopPropagation(),c(void 0)},classes:{paper:n.paper}},t))}Wn=Object(dn.a)(e=>({enableHover:{"&:hover":{backgroundColor:`${e.palette.hover.light} !important`}}}),{withTheme:!0})(Wn),Wn=Object(s.b)(e=>{return{items:W(e)}})(Wn),qn=Object(dn.a)({paper:{padding:"1em"}})(qn);var Qn=function(){const e=Object(s.d)(J),t=Object(s.d)(H),n=Object(s.c)(),o=Object(a.useRef)(void 0);async function c(){switch(await n(Ke(e))){case 200:n(Ae());break;case 204:o.current=setTimeout(()=>c(),5e3)}}return Object(a.useEffect)(()=>{const{status:a,STATUSES:r,code:s,items:l,name:i}=t.data;switch(n(A(i||e)),a){case r.edit:""==s&&n(We(e));break;case r.done:case r.error:l||c()}return()=>{n(A(void 0)),clearTimeout(o.current)}},[]),Object(a.useEffect)(()=>{switch(t.data.status){case"process":o.current=setTimeout(()=>c(),5e3)}},[t.data.status]),function(){const{status:e,STATUSES:n,error:a,items:o}=t.data;let c;switch(e){case n.empty:case n.edit:c=r.a.createElement($t,{processOptions:{analysis:["0-cfa","1-cfa","2-cfa"]},edit:!0});break;case n.process:c=r.a.createElement(St,{status:"Processing",variant:"circular"});break;case n.done:c=o?r.a.createElement(It,{vertical:!0},r.a.createElement(wt,{width:"40%"},r.a.createElement(Bt,null)),r.a.createElement(wt,{width:"60%"},r.a.createElement(It,{horizontal:!0},r.a.createElement(wt,{height:"48%"},r.a.createElement(It,{vertical:!0},r.a.createElement(wt,{width:"48%",overflow:"auto"},r.a.createElement(qt,null)),r.a.createElement(wt,{width:"52%"},r.a.createElement(Bn,null)))),r.a.createElement(wt,{height:"52%",overflow:"auto"},r.a.createElement(It,null,r.a.createElement(wt,{width:"50%",overflow:"auto"},r.a.createElement(Dn,null)),r.a.createElement(wt,{width:"50%",overflow:"auto"},r.a.createElement(_n,null))))))):r.a.createElement(St,{status:"Downloading",variant:"circular"});break;case n.error:c=r.a.createElement($t,{error:!0,errorContent:a})}return c}()},Yn=n(95),Xn=n.n(Yn),Zn=n(96),ea=n.n(Zn),ta=n(40),na=n.n(ta),aa=n(75),ra=n.n(aa),oa=n(76),ca=n.n(oa);var sa=Xn()({palette:{secondary:{light:na.a[300],main:na.a[500],dark:na.a[700]},select:{light:na.a[100],main:na.a[400]},hover:{light:ra.a[100],main:ra.a[400]},suggest:{main:ca.a[400],dark:ca.a[700]},warn:{main:ea.a.A700,contrastText:"#fff"}}}),la=n(235),ia=n(226),ua=n(227);var da=Object(s.b)(e=>{const t=Ee(e);return{projectId:t,name:t?V(e,t).name:""}},{rename:function(e,t){return async function(n){const a=de(D.getState());return n(_(e,{name:t})),fetch(`/api/${a}/projects/${e}/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t})})}},setRenameDialog:Ge})(function(e){const{projectId:t,name:n,rename:o,setRenameDialog:c}=e,[s,l]=Object(a.useState)(void 0);function i(){c(void 0)}return Object(a.useEffect)(()=>l(n||""),[n]),r.a.createElement(la.a,{open:Boolean(t),onClose:i},r.a.createElement(ia.a,null,r.a.createElement(tt.a,{label:"name",value:s,onChange:e=>l(e.target.value),placeholder:`project ${t} name`})),r.a.createElement(ua.a,null,r.a.createElement(Xe.a,{onClick:i},"cancel"),r.a.createElement(Xe.a,{onClick:()=>{i(),o(t,s)}},"rename")))}),pa=n(232),fa=n(97),ma=n.n(fa);var ha=function(){const e=Object(s.d)(he),t=Object(s.c)(),[n,o]=Object(a.useState)(void 0);function c(){clearTimeout(n),t(ze())}return Object(a.useEffect)(()=>{e&&o(setTimeout(()=>{c()},2e4))},[e]),r.a.createElement(pa.a,{open:Boolean(e),onClose:function(e,t){"clickaway"!==t&&c()},action:[r.a.createElement(st.a,{key:"close",onClick:c,color:"inherit"},r.a.createElement(ma.a,null))],autoHideDuration:2e4,message:e,anchorOrigin:{horizontal:"left",vertical:"bottom"}})};var Ea=function(){const e=Object(s.d)(pe),t=Object(s.d)(fe),n=Object(s.d)(J),o=Object(s.c)();let c,l,i;switch(e){case oe:c=r.a.createElement(nt,null);break;case ce:l=r.a.createElement(ga,null),i=r.a.createElement(a.Fragment,null,r.a.createElement(va,null),r.a.createElement(ba,{content:"new project",onClick:()=>o(Je())}),r.a.createElement(ya,null)),c=r.a.createElement(bt,null);break;case se:l=r.a.createElement(ga,null),i=r.a.createElement(a.Fragment,null,r.a.createElement(ba,{content:"fork project",onClick:()=>o(He(n))}),r.a.createElement(ba,{content:"export project",onClick:()=>o(qe(n))}),r.a.createElement(ya,null)),c=r.a.createElement(Qn,null)}const u=r.a.createElement(Qe.a,{position:"static"},r.a.createElement(Ye.a,null,l,r.a.createElement(Ze.a,{variant:"h6",color:"inherit",style:{flex:"1 1 auto",overflow:"hidden",textOverflow:"ellipsis",textAlign:"center"}},t),i));return r.a.createElement(et.a,{theme:sa},r.a.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"}},!1,u,c,r.a.createElement(ha,null),r.a.createElement(da,null)))};function ga(){const e=Object(s.c)();return r.a.createElement(ba,{content:"project list",onClick:()=>e(F(void 0))})}function ya(){const e=Object(s.c)();return r.a.createElement(ba,{content:"logout",onClick:t=>e(function(e){return e=>{e(R(void 0)),e(L())}}())})}function va(){const e=Object(a.useRef)(void 0),t=Object(s.c)();function n(n){const a=new FileReader;a.onload=()=>{const e=JSON.parse(a.result),r=n.name.match(/aam-vis-(.*)\.js/)[1];t(function(e,t){return n=>{n(N(e)),n(_(e,t)),n(Ae(e))}}(r,e))},a.readAsText(n),e.current.value=""}return r.a.createElement(a.Fragment,null,r.a.createElement(ba,{content:"import",onClick:()=>e.current.click()}),r.a.createElement("input",{ref:e,onChange:()=>n(e.current.files[0]),type:"file",hidden:!0}))}function ba(e){const{content:t,onClick:n}=e;return r.a.createElement(Xe.a,{onClick:n,color:"inherit",variant:"outlined",style:{margin:sa.spacing(1)}},t)}n(143);c.a.render(r.a.createElement(s.a,{store:D},r.a.createElement(Ea,null)),document.getElementById("app"))}});